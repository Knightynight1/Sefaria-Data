# -*- coding: utf-8 -*-
"""
Post a sheet form the local environment to a remote environment, using an API Key.
"""
import django
django.setup()
import urllib2
import requests
import regex as re
from sefaria.system.database import db
from sefaria.sheets import get_sheet
from sources.functions import post_sheet, http_request
from sources.local_settings import *


# GET_SERVER = "http://nechama.sandbox.sefaria.org"
# GET_SERVER = "http://qanechama.sandbox.sefaria.org"
GET_SERVER = "http://localhost:8000"
# GET_SERVER = "http://einmishpat.sandbox.sefaria.org"
# GET_SERVER = "http://shmuel.sandbox.sefaria.org"
# GET_SERVER = "http://ravnataf.sandbox.sefaria.org"

# POST_SERVER = "http://nechama.sandbox.sefaria.org"
# POST_SERVER = "http://qanechama.sandbox.sefaria.org"
POST_SERVER = "http://localhost:8000"
# POST_SERVER = "https://www.sefaria.org"
# POST_SERVER = "http://shmuel.sandbox.sefaria.org"
# POST_SERVER = "https://www.sefaria.org"

get_server = GET_SERVER
post_server = POST_SERVER

no_pdf = [20, 55, 66, 69, 76, 99, 101, 109, 118, 119, 120, 160, 181, 182, 183, 187, 191, 205, 230, 250, 259, 261, 289, 298, 314, 353, 354, 365, 368, 392, 410, 411, 423, 425, 426, 463, 479, 482, 516, 544, 554, 571, 578, 594, 603, 607, 619, 620, 627, 638, 648, 662, 663, 677, 689, 696, 704, 708, 734, 737, 755, 757, 759, 762, 784, 797, 809, 814, 816, 829, 838, 857, 879, 884, 906, 908, 923, 941, 956, 957, 964, 987, 1015, 1030, 1059, 1117, 1119, 1136, 1145, 1153, 1164, 1195, 1204, 1220, 1242, 1263, 1347, 1404, 1416, 1432, 1439, 1442, 1453, 1454, 1460, 1462, 1463, 1464, 1465, 1468, 1470, 1471, 1473, 1474, 1475, 1476, 1477,1478]

def linking(json_sheet, post_id=None):
    if not post_id:
        post_id=json_sheet['id']
    json_sheet_str = str(json_sheet).replace(u'\\\\', u'')
    url = get_server + "/api/sheets/{}".format(post_id)
    got = http_request(url, body={"apikey": API_KEY}, method="GET")
    compile = re.compile(u'(?P<aref><a.*?/sheets.*?>(?P<text>.*?)</a>)')
    for match in re.finditer(compile, str(got)):
        json_sheet_str = re.sub(match.group('text'), match.group('aref'), json_sheet_str)
    return eval(json_sheet_str)

def change_sheet(this_sheet, del_tags=[], add_tags=[], pdf_action = ''):
    # deal with tags
    to_delete = []  # the list of tags to delete - so not to change the list while still iterating through it
    for tag in this_sheet[u'tags']:
        if isinstance(tag, int) or tag.isdigit():
            tag = str(tag).strip()
            # todo: deal with the pdf link
            # this_sheet['summary'] = this_sheet['summary'] + u" http://www.nechama.org.il/pdf/{}.pdf".format(tag)
            this_sheet["ssn"] = int(tag)
            if "int_tag" in del_tags:
                to_delete.append(tag)
                this_sheet['ssn'] = int(tag)
        if (tag in del_tags) or re.search(u'[א-ת]', tag):
            to_delete.append(tag) #this_sheet[u'tags'].remove(tag)
        if tag == 'Bilingual':
            add_tags.append('English')
            this_sheet['summary'] = this_sheet['summary'] + u'<br>Editing and additional translation of English by R. Francis Nataf'
        if tag == 'merged':
            add_tags.append('Merged')
    for tag in to_delete:
        this_sheet[u'tags'].remove(tag)
    this_sheet[u'tags'].extend(add_tags)
    # deal with owner todo: make this work also throw the api post
    this_sheet["status"] = "unlisted"
    # pdf_link_str = u"www.nechama.org.il/pdf/{}.pdf".format(this_sheet['ssn'])
    # this_sheet['sources'].insert(0,{'node': '0', 'outsideText':'<a href=\"{}\" target=\"_blank\">{}</a>'.format(pdf_link_str, pdf_link_str)})
    # this_sheet = linking(this_sheet)
    if pdf_action:
        this_sheet = add_pdf_link(this_sheet, action=pdf_action)
    # del this_sheet['_id']
    return this_sheet

def add_pdf_link(this_sheet, action="add"):
    if this_sheet['ssn'] in no_pdf:
        return this_sheet
    url = u"http://www.nechama.org.il/pdf/{}.pdf".format(this_sheet['ssn'])
    aref = u'''</br><a href="{}" target="_blank">see original ראה מקור</a>'''.format(url)
    if action =='add':
        this_sheet['summary'] = this_sheet['summary'] + aref
    elif action == 'delete':
        this_sheet['summary'] = re.sub(u'<.*>', u'', this_sheet['summary'])
    elif action == 'change':
        this_sheet['summary'] = re.sub(u'see original ראה מקור', u'View Original צפה בגרסת המקור', this_sheet['summary'])
    return this_sheet




def post_btween_sandboxes(ssn=None, map_ssn_url_post=None, map_ssn_url_get=None, id=None, id_post=None, new_post = False, pdf_action="", repost_to_local = False):
    if not ssn and not id:
        print "missing either a ssn or an sheet_id of the sheet to be posted"
        return
    if ssn:
        try:
            assert map_ssn_url_get and map_ssn_url_post
        except AssertionError:
            print "if using ssn you must give the corresponding maps"
        try:
            if not new_post:
                post_sheet_id = map_ssn_url_post[ssn]  # the latest sheet with that ssn number we want to repost over
            get_sheet_id = map_ssn_url_get[ssn]  # can also be from a ssn mapping from the correct server the fixed sheet that was created (sometimes from the old sheet itself), need to know it
        except KeyError:
            return
    else:  # id - because if it is neither we returns already :)
        get_sheet_id = id
        if id_post:
            post_sheet_id = id_post
        else:
            post_sheet_id = id

    url = get_server + "/api/sheets/{}".format(get_sheet_id)
    got = http_request(url, body={"apikey": API_KEY}, method="GET")

    # got = linking(got, post_sheet_id)
    changed = change_sheet(got, add_tags=[], del_tags=["UI", 'int_tag', 'Hebrew Sheet', 'Bilingual', 'Edited', 'Linked', 'merged', 'QA', "Merged"], pdf_action=pdf_action)


    if new_post:
        del changed['id']
    else:
        changed['id'] = post_sheet_id
        # # delete sheet in post sheet number - note: when it is reposting the sheet will only be in this script RAM so always!!! have a backup
        # delete_url = post_server + "/api/sheets/{}/delete".format(post_sheet_id)
        # response = http_request(delete_url, body={"apikey": API_KEY})
        # if re.search("Sheet {} not found.".format(post_sheet_id), response):
        #     del changed['id']
    if repost_to_local:
        post_over_sheet = db.sheets.find_one({'id': post_sheet_id})
        changed['_id'] = post_over_sheet['_id']
        db.sheets.update({'_id': post_over_sheet["_id"]}, changed)
    else:
        del changed['_id']
        #post the copyed sheet in there
        response = post_sheet(changed, server=POST_SERVER)
        if isinstance(response, unicode) and re.search('error', response):
            with open(u"nopost.html", 'a') as f:
                writer = f.write(response)
## post them over themself (for the sheet to sheet linking process)

# sheets = [map_ssn_url[x] for x in ssn_sheets]
# for ssn in sheets_ssn:
#     got = get_sheet(sheet[u'id'])
#     url = SEFARIA_SERVER + "/api/sheets/{}".format(sheet_id)
#     got = http_request(url, body={"apikey": API_KEY}, method="GET")
#     changed = change_sheet(got, add_tags=[])
#     changed['id'] = post_ssn_map[ssn]
#     del changed['_id']
#     post_sheet(changed, server=SEFARIA_SERVER)
# pass
if __name__ == "__main__":
    # create this mapping on the GET_SERVER via map_ssn_url.py on the correct db
    map_post = {1: 160441, 2: 160442, 3: 160443, 4: 160444, 5: 160445, 6: 160446, 7: 160447, 8: 160448, 9: 160449, 10: 160450, 11: 160451, 12: 160452, 13: 160453, 14: 160454, 15: 160455, 16: 160456, 17: 160457, 18: 160458, 19: 160459, 20: 160460, 21: 160461, 22: 160462, 23: 160463, 24: 160464, 25: 160465, 26: 160466, 28: 160467, 29: 160468, 30: 160469, 31: 160470, 32: 160471, 33: 160472, 34: 160473, 36: 160474, 37: 160475, 38: 160476, 39: 160477, 40: 160478, 41: 160479, 42: 160480, 43: 160481, 44: 160482, 46: 160483, 47: 160484, 49: 160485, 50: 160486, 54: 160487, 55: 160488, 56: 160489, 57: 160490, 58: 160491, 59: 160492, 60: 160493, 61: 160494, 62: 160495, 63: 160496, 64: 160497, 65: 160498, 67: 160499, 68: 160500, 70: 160501, 71: 160502, 72: 160503, 73: 160504, 74: 160505, 75: 160506, 76: 160507, 77: 160508, 78: 160509, 79: 160510, 80: 160511, 81: 160512, 82: 160513, 83: 160514, 84: 160515, 85: 160516, 86: 160517, 87: 160518, 88: 160519, 89: 160520, 90: 160521, 91: 160522, 92: 160523, 93: 160524, 94: 160525, 95: 160526, 96: 160527, 97: 160528, 98: 160529, 99: 160530, 100: 160531, 101: 160532, 102: 160533, 103: 160534, 104: 160535, 105: 160536, 106: 160537, 107: 160538, 108: 160539, 109: 160540, 110: 160542, 111: 160543, 112: 160544, 113: 160545, 114: 160546, 116: 160547, 117: 160548, 119: 160549, 120: 160550, 121: 160551, 122: 160552, 123: 160553, 124: 160554, 125: 160555, 126: 160556, 127: 160557, 128: 160558, 129: 160559, 130: 160560, 131: 160561, 132: 160562, 133: 160563, 134: 160564, 135: 160565, 136: 160566, 137: 160567, 138: 160568, 139: 160569, 140: 160570, 141: 160571, 143: 160572, 144: 160573, 145: 160574, 146: 160575, 147: 160576, 148: 160577, 149: 160578, 150: 160579, 151: 160580, 152: 160581, 153: 160582, 154: 160583, 155: 160584, 156: 160585, 157: 160586, 158: 160587, 159: 160588, 160: 160589, 161: 160590, 162: 160591, 163: 160592, 164: 160593, 165: 160594, 166: 160595, 167: 160596, 168: 160597, 170: 160598, 171: 160599, 172: 160600, 173: 160601, 175: 160602, 176: 160603, 177: 160604, 178: 160605, 179: 160606, 180: 160607, 181: 160608, 182: 160609, 183: 160610, 184: 160611, 185: 160612, 186: 160613, 187: 160614, 188: 160615, 189: 160616, 190: 160617, 191: 160618, 192: 160619, 193: 160620, 194: 160621, 195: 160622, 196: 160623, 197: 160624, 198: 160625, 199: 160626, 200: 160627, 201: 160628, 202: 160629, 203: 160630, 204: 160631, 206: 160632, 207: 160633, 208: 160634, 209: 160635, 210: 160636, 211: 160637, 212: 160638, 213: 160639, 214: 160640, 215: 160641, 216: 160642, 217: 160643, 218: 160644, 219: 160645, 220: 160646, 221: 160647, 222: 160648, 223: 160649, 224: 160650, 225: 160651, 226: 160652, 227: 160653, 228: 160654, 229: 160655, 230: 160656, 231: 160657, 232: 160658, 233: 160659, 234: 160660, 235: 160661, 236: 160662, 237: 160663, 238: 160664, 239: 160665, 240: 160666, 241: 160667, 242: 160668, 243: 160669, 244: 160670, 245: 160671, 247: 160672, 248: 160673, 249: 160674, 250: 160675, 251: 160676, 252: 160677, 253: 160678, 254: 160679, 255: 160680, 256: 160681, 257: 160682, 258: 160683, 259: 160684, 260: 160685, 261: 160686, 262: 160687, 263: 160688, 264: 160689, 265: 160690, 266: 160691, 267: 160692, 268: 160693, 269: 160694, 270: 160695, 271: 160696, 272: 160697, 273: 160698, 274: 160699, 275: 160700, 276: 160701, 277: 160702, 278: 160703, 279: 160704, 280: 160705, 281: 160706, 282: 160707, 283: 160708, 284: 160709, 285: 160710, 286: 160711, 287: 160712, 288: 160713, 289: 160714, 290: 160715, 291: 160716, 292: 160717, 293: 160718, 294: 160719, 295: 160720, 297: 160721, 298: 160722, 299: 160723, 300: 160724, 301: 160725, 302: 160726, 303: 160727, 304: 160728, 305: 160729, 306: 160730, 307: 160731, 308: 160732, 309: 160733, 310: 160734, 311: 160735, 312: 160736, 313: 160737, 314: 160738, 315: 160739, 316: 160740, 317: 160741, 318: 160746, 319: 160747, 320: 160748, 321: 160749, 322: 160750, 323: 160751, 324: 160752, 325: 160753, 326: 160754, 327: 160755, 328: 160756, 329: 160757, 330: 160758, 331: 160759, 332: 160760, 333: 160761, 334: 160762, 335: 160763, 336: 160764, 337: 160765, 338: 160766, 339: 160767, 340: 160768, 341: 160769, 342: 160770, 343: 160771, 344: 160772, 345: 160773, 346: 160774, 347: 160775, 348: 160776, 349: 160777, 350: 160778, 351: 160779, 352: 160785, 353: 160786, 354: 160787, 355: 160788, 356: 160789, 357: 160790, 358: 160791, 359: 160792, 360: 160793, 361: 160794, 362: 160795, 363: 160796, 364: 160797, 365: 160798, 366: 160799, 367: 160800, 368: 160801, 369: 160802, 370: 160803, 371: 160804, 372: 160805, 373: 160817, 374: 160818, 375: 160819, 376: 160820, 377: 160822, 378: 160823, 379: 160824, 380: 160825, 381: 160826, 382: 160827, 383: 160828, 384: 160829, 385: 160830, 386: 160831, 387: 160832, 388: 160833, 389: 160834, 390: 160835, 391: 160836, 392: 160837, 393: 160838, 394: 160839, 395: 160840, 396: 160841, 397: 160842, 398: 160843, 399: 160844, 400: 160845, 401: 160846, 402: 160847, 403: 160848, 404: 160849, 405: 160850, 406: 160851, 407: 160852, 408: 160853, 409: 160854, 410: 160855, 411: 160856, 412: 160857, 413: 160858, 414: 160859, 415: 160860, 416: 160861, 417: 160862, 418: 161071, 419: 161072, 420: 161073, 421: 161074, 422: 161075, 423: 161076, 424: 161077, 425: 161078, 426: 161079, 427: 161080, 428: 161081, 429: 161082, 430: 161083, 431: 161084, 432: 161085, 433: 161086, 434: 161087, 435: 161088, 436: 161089, 437: 161090, 438: 161091, 439: 161092, 440: 161093, 441: 161094, 442: 161095, 443: 161096, 444: 161097, 445: 161098, 446: 161099, 447: 161100, 448: 161101, 449: 161102, 450: 161103, 451: 161104, 452: 161105, 453: 161106, 454: 161107, 455: 161108, 456: 161109, 457: 161110, 458: 161111, 459: 161112, 460: 161113, 461: 161114, 462: 161115, 463: 161116, 464: 161117, 465: 161118, 466: 161119, 467: 161120, 468: 161121, 469: 161122, 470: 161123, 471: 161124, 472: 161125, 473: 161126, 474: 161127, 475: 161128, 476: 161129, 477: 161130, 478: 161131, 479: 161132, 480: 161133, 481: 161134, 482: 161135, 483: 161136, 484: 161137, 485: 161138, 486: 161139, 487: 161140, 488: 161141, 489: 161142, 490: 161143, 491: 161144, 492: 161145, 493: 161146, 494: 161147, 495: 161148, 496: 161149, 497: 161150, 498: 161151, 499: 161152, 500: 161153, 501: 161154, 502: 161155, 503: 161156, 504: 161157, 505: 161158, 506: 161159, 507: 161160, 508: 161161, 509: 161162, 510: 161163, 511: 161164, 512: 161165, 513: 161166, 514: 161167, 515: 161168, 516: 161169, 517: 161170, 518: 161171, 519: 161172, 520: 161173, 521: 161174, 522: 161175, 523: 161176, 524: 161177, 525: 161178, 526: 161179, 527: 161180, 528: 161181, 529: 161182, 530: 161183, 531: 161184, 532: 161185, 533: 161186, 534: 161187, 535: 161188, 536: 161189, 537: 161190, 538: 161191, 539: 161192, 540: 161193, 541: 161194, 542: 161195, 543: 161196, 544: 161197, 545: 161198, 546: 161199, 547: 161200, 548: 161201, 549: 161202, 550: 161203, 551: 161204, 552: 161205, 553: 161206, 554: 161207, 555: 161208, 556: 161209, 557: 161210, 558: 161211, 559: 161212, 560: 161213, 561: 161214, 562: 161215, 563: 161216, 564: 161217, 565: 161218, 566: 161219, 567: 161220, 568: 161221, 569: 161222, 570: 161223, 571: 161224, 572: 161225, 573: 161226, 574: 161227, 575: 161228, 576: 161229, 577: 161230, 579: 161231, 580: 161232, 581: 161233, 582: 161234, 583: 161235, 584: 161236, 585: 161237, 586: 161238, 587: 161239, 588: 161240, 589: 161241, 590: 161242, 591: 161243, 592: 161244, 593: 161245, 594: 161246, 595: 161247, 596: 161248, 597: 161249, 598: 161250, 599: 161251, 600: 161252, 601: 161253, 602: 161254, 603: 161255, 604: 161256, 605: 161257, 606: 161258, 607: 161259, 608: 161260, 609: 161261, 610: 161262, 611: 161263, 612: 161264, 613: 161265, 614: 161266, 615: 161267, 616: 161268, 617: 161269, 618: 161270, 619: 161271, 620: 161272, 621: 161273, 622: 161274, 623: 161275, 624: 161276, 625: 161277, 626: 161278, 628: 161279, 629: 161280, 630: 161281, 631: 161282, 632: 161283, 633: 161284, 634: 161285, 635: 161286, 636: 161287, 637: 161288, 638: 161289, 639: 161290, 640: 161291, 641: 161292, 642: 161293, 643: 161294, 644: 161295, 645: 161296, 646: 161297, 647: 161298, 648: 161299, 649: 161300, 650: 161301, 651: 161302, 652: 161303, 653: 161304, 654: 161305, 655: 161306, 656: 161307, 657: 161308, 658: 161309, 659: 161310, 660: 161311, 661: 161312, 662: 161313, 663: 161314, 664: 161315, 665: 161316, 666: 161317, 667: 161318, 668: 161319, 669: 161320, 670: 161321, 671: 161322, 672: 161323, 673: 161324, 674: 161325, 675: 161326, 676: 161327, 677: 161328, 678: 161329, 679: 161330, 680: 161331, 681: 161332, 682: 161333, 683: 161334, 684: 161335, 685: 161336, 686: 161337, 687: 161338, 688: 161339, 689: 161340, 690: 161341, 691: 161342, 692: 161343, 693: 161344, 694: 161345, 695: 161346, 696: 161347, 697: 161348, 698: 161349, 699: 161350, 700: 161351, 701: 161352, 702: 161353, 703: 161354, 704: 161355, 705: 161356, 706: 161357, 707: 161358, 708: 161359, 709: 161360, 710: 161361, 711: 161362, 712: 161363, 713: 161364, 714: 161365, 715: 161366, 716: 161367, 717: 161368, 718: 161369, 719: 161370, 720: 161371, 721: 161372, 722: 161373, 723: 161374, 724: 161375, 725: 161376, 726: 161377, 727: 161378, 728: 161379, 729: 161380, 730: 161381, 731: 161382, 732: 161383, 733: 161384, 734: 161385, 735: 161386, 736: 161387, 737: 161388, 738: 161389, 739: 161390, 740: 161391, 741: 161392, 742: 161393, 743: 161394, 744: 161395, 745: 161396, 746: 161397, 747: 161398, 748: 161399, 749: 161400, 750: 161401, 751: 161402, 752: 161403, 753: 161404, 754: 161405, 755: 161406, 756: 161407, 757: 161408, 758: 161409, 759: 161410, 760: 161411, 761: 161412, 762: 161413, 763: 161414, 764: 161415, 765: 161416, 766: 161417, 767: 161418, 768: 161419, 769: 161420, 770: 161421, 771: 161422, 772: 161423, 773: 161424, 774: 161425, 775: 161426, 776: 161427, 777: 161428, 778: 161429, 779: 161430, 780: 161431, 781: 161432, 782: 161433, 783: 161434, 784: 161435, 785: 161436, 786: 161437, 787: 161438, 788: 161439, 789: 161440, 790: 161441, 791: 161442, 792: 161443, 793: 161444, 794: 161445, 795: 161446, 796: 161447, 797: 161448, 798: 161449, 799: 161450, 800: 161451, 801: 161452, 802: 161453, 803: 161454, 804: 161455, 805: 161456, 806: 161457, 807: 161458, 808: 161459, 809: 161460, 810: 161461, 811: 161462, 812: 161463, 813: 161464, 814: 161465, 815: 161466, 816: 161467, 817: 161468, 818: 161469, 819: 161470, 820: 161471, 821: 161472, 822: 161473, 823: 161474, 824: 161475, 825: 161476, 826: 161477, 827: 161478, 828: 161479, 829: 161480, 830: 161481, 831: 161482, 832: 161483, 833: 161484, 834: 161485, 835: 161486, 836: 161487, 837: 161488, 838: 161489, 839: 161490, 840: 161491, 841: 161492, 842: 161493, 843: 161494, 844: 161495, 845: 161496, 846: 161497, 847: 161498, 848: 161499, 849: 161500, 850: 161501, 851: 161502, 852: 161503, 853: 161504, 854: 161505, 855: 161506, 856: 161507, 857: 161508, 858: 161509, 859: 161510, 860: 161511, 861: 161512, 862: 161513, 863: 161514, 864: 161515, 865: 161516, 866: 161517, 867: 161518, 868: 161519, 869: 161520, 870: 161521, 871: 161522, 872: 161523, 873: 161524, 874: 161525, 875: 161526, 876: 161527, 877: 161528, 878: 161529, 879: 161530, 880: 161531, 881: 161532, 882: 161533, 883: 161534, 884: 161535, 885: 161536, 886: 161537, 887: 161538, 888: 161539, 889: 161540, 890: 161541, 891: 161542, 892: 161543, 893: 161544, 894: 161545, 895: 161546, 896: 161547, 897: 161548, 898: 161549, 899: 161550, 900: 161551, 901: 161552, 902: 161553, 903: 161554, 904: 161555, 905: 161556, 906: 161557, 907: 161558, 908: 161559, 909: 161560, 910: 161561, 911: 161562, 912: 161563, 913: 161564, 914: 161565, 915: 161566, 916: 161567, 917: 161568, 918: 161569, 919: 161570, 920: 161571, 921: 161572, 922: 161573, 923: 161574, 924: 161575, 925: 161576, 926: 161577, 927: 161578, 928: 161579, 929: 161580, 930: 161581, 931: 161582, 932: 161583, 933: 161584, 934: 161585, 935: 161587, 936: 161588, 937: 161589, 938: 161590, 939: 161591, 940: 161592, 941: 161593, 942: 161594, 943: 161595, 944: 161596, 945: 161597, 946: 161598, 947: 161599, 948: 161600, 949: 161601, 950: 161602, 951: 161603, 952: 161604, 953: 161605, 954: 161606, 955: 161607, 956: 161608, 957: 161609, 958: 161610, 959: 161611, 960: 161612, 961: 161613, 962: 161614, 963: 161615, 964: 161616, 965: 161617, 966: 161618, 967: 161619, 968: 161620, 969: 161621, 970: 161622, 971: 161623, 972: 161624, 973: 161625, 974: 161626, 975: 161627, 976: 161628, 977: 161629, 978: 161630, 979: 161631, 980: 161632, 981: 161633, 982: 161634, 983: 161635, 984: 161636, 985: 161637, 986: 161638, 988: 161639, 989: 161640, 990: 161641, 991: 161642, 992: 161643, 993: 161644, 994: 161645, 995: 161646, 996: 161647, 997: 161648, 998: 161649, 999: 161650, 1000: 161651, 1001: 161652, 1002: 161653, 1003: 161654, 1004: 161655, 1005: 161656, 1006: 161657, 1007: 161658, 1008: 161659, 1009: 161660, 1010: 161661, 1011: 161662, 1012: 161663, 1013: 161664, 1014: 161665, 1015: 161666, 1016: 161667, 1017: 161668, 1018: 161669, 1019: 161670, 1020: 161671, 1021: 161672, 1022: 161673, 1023: 161674, 1024: 161675, 1025: 161676, 1026: 161677, 1027: 161678, 1028: 161679, 1029: 161680, 1030: 161681, 1031: 161682, 1032: 161683, 1033: 161684, 1034: 161685, 1035: 161686, 1036: 161687, 1037: 161688, 1038: 161689, 1039: 161690, 1040: 161691, 1041: 161692, 1042: 161693, 1043: 161694, 1044: 161695, 1045: 161696, 1046: 161697, 1047: 161698, 1048: 161699, 1049: 161700, 1050: 161701, 1051: 161702, 1052: 161703, 1053: 161704, 1054: 161705, 1055: 161706, 1056: 161707, 1057: 161708, 1058: 161709, 1059: 161710, 1060: 161711, 1061: 161712, 1062: 161713, 1063: 161714, 1064: 161715, 1065: 161716, 1066: 161717, 1067: 161718, 1068: 161719, 1069: 161720, 1070: 161721, 1071: 161722, 1072: 161723, 1073: 161724, 1074: 161725, 1075: 161726, 1076: 161727, 1077: 161728, 1078: 161729, 1079: 161730, 1080: 161731, 1081: 161732, 1082: 161733, 1083: 161734, 1084: 161735, 1085: 161736, 1086: 161737, 1087: 161738, 1088: 161739, 1089: 161740, 1090: 161741, 1091: 161742, 1092: 161743, 1093: 161744, 1094: 161745, 1095: 161746, 1096: 161747, 1097: 161748, 1098: 161749, 1099: 161750, 1100: 161751, 1101: 161752, 1102: 161753, 1103: 161754, 1104: 161755, 1105: 161756, 1106: 161757, 1107: 161758, 1108: 161759, 1109: 161760, 1110: 161761, 1111: 161762, 1112: 161763, 1113: 161764, 1114: 161765, 1115: 161766, 1116: 161767, 1117: 161768, 1118: 161769, 1119: 161770, 1120: 161771, 1121: 161772, 1122: 161773, 1123: 161774, 1124: 161775, 1125: 161776, 1126: 161777, 1127: 161778, 1128: 161779, 1129: 161780, 1130: 161781, 1131: 161782, 1132: 161783, 1133: 161784, 1134: 161785, 1135: 161786, 1136: 161787, 1137: 161788, 1138: 161789, 1139: 161790, 1140: 161791, 1141: 161792, 1142: 161793, 1143: 161794, 1144: 161795, 1145: 161796, 1146: 161797, 1147: 161798, 1148: 161799, 1149: 161800, 1150: 161801, 1151: 161802, 1152: 161803, 1153: 161804, 1154: 161805, 1155: 161806, 1156: 161807, 1157: 161808, 1158: 161809, 1159: 161810, 1160: 161811, 1161: 161812, 1162: 161813, 1163: 161814, 1164: 161815, 1165: 161816, 1166: 161817, 1167: 161818, 1168: 161819, 1169: 161820, 1170: 161821, 1171: 161822, 1172: 161823, 1173: 161824, 1174: 161825, 1175: 161826, 1176: 161827, 1177: 161828, 1178: 161829, 1179: 161830, 1180: 161831, 1181: 161832, 1182: 161833, 1183: 161834, 1184: 161835, 1185: 161836, 1186: 161837, 1187: 161838, 1188: 161839, 1189: 161840, 1190: 161841, 1191: 161842, 1192: 161843, 1193: 161844, 1194: 161845, 1195: 161846, 1196: 161847, 1197: 161848, 1198: 161849, 1199: 161850, 1200: 161851, 1201: 161852, 1202: 161853, 1203: 161854, 1204: 161855, 1205: 161856, 1206: 161857, 1207: 161858, 1208: 161859, 1209: 161860, 1210: 161861, 1211: 161862, 1212: 161863, 1213: 161864, 1214: 161865, 1215: 161866, 1216: 161867, 1217: 161868, 1218: 161869, 1219: 161870, 1220: 161871, 1221: 161872, 1222: 161873, 1223: 161874, 1224: 161875, 1225: 161876, 1226: 161877, 1227: 161878, 1228: 161879, 1229: 161880, 1230: 161881, 1231: 161882, 1232: 161883, 1233: 161884, 1234: 161885, 1235: 161886, 1236: 161887, 1237: 161888, 1238: 161889, 1239: 161890, 1240: 161891, 1241: 161892, 1243: 161893, 1244: 161894, 1245: 161895, 1246: 161896, 1247: 161897, 1248: 161898, 1249: 161899, 1250: 161900, 1251: 161901, 1252: 161902, 1253: 161903, 1254: 161904, 1255: 161905, 1256: 161906, 1257: 161907, 1258: 161908, 1259: 161909, 1260: 161910, 1261: 161911, 1262: 161912, 1263: 161913, 1264: 161914, 1265: 161915, 1266: 161916, 1267: 161917, 1268: 161918, 1269: 161919, 1270: 161920, 1271: 161921, 1272: 161922, 1273: 161923, 1274: 161924, 1275: 161925, 1276: 161926, 1277: 161927, 1278: 161928, 1279: 161929, 1280: 161930, 1281: 161931, 1282: 161932, 1283: 161933, 1284: 161934, 1285: 161935, 1286: 161936, 1287: 161937, 1288: 161938, 1289: 161939, 1290: 161940, 1291: 161941, 1292: 161942, 1293: 161943, 1294: 161944, 1295: 161945, 1296: 161946, 1297: 161947, 1298: 161948, 1299: 161949, 1300: 161950, 1301: 161951, 1302: 161952, 1303: 161953, 1304: 161954, 1305: 161955, 1306: 161956, 1307: 161957, 1308: 161958, 1309: 161959, 1310: 161960, 1311: 161961, 1312: 161962, 1313: 161963, 1314: 161964, 1315: 161965, 1316: 161966, 1317: 161967, 1318: 161968, 1319: 161969, 1320: 161970, 1321: 161971, 1322: 161972, 1323: 161973, 1324: 161974, 1325: 161975, 1326: 161976, 1327: 161977, 1328: 161978, 1329: 161979, 1330: 161980, 1331: 161981, 1332: 161982, 1333: 161983, 1334: 161984, 1335: 161985, 1336: 161986, 1337: 161987, 1338: 161988, 1339: 161989, 1340: 161990, 1341: 161991, 1342: 161992, 1343: 161993, 1344: 161994, 1345: 161995, 1346: 161996, 1348: 161997, 1349: 161998, 1350: 161999, 1351: 162000, 1352: 162001, 1353: 162002, 1354: 162003, 1355: 162004, 1356: 162005, 1357: 162006, 1358: 162007, 1359: 162008, 1360: 162009, 1361: 162010, 1362: 162011, 1363: 162012, 1364: 162013, 1365: 162014, 1366: 162015, 1367: 162016, 1368: 162017, 1369: 162018, 1370: 162019, 1371: 162020, 1372: 162021, 1373: 162022, 1374: 162023, 1375: 162024, 1376: 162025, 1377: 162026, 1378: 162027, 1379: 162028, 1380: 162029, 1381: 162030, 1382: 162031, 1383: 162032, 1384: 162033, 1385: 162034, 1386: 162035, 1387: 162036, 1388: 162037, 1389: 162038, 1390: 162039, 1391: 162040, 1392: 162041, 1393: 162042, 1394: 162043, 1395: 162044, 1396: 162045, 1397: 162046, 1398: 162047, 1399: 162048, 1400: 162049, 1401: 162050, 1402: 162051, 1403: 162052, 1404: 162053, 1405: 162054, 1406: 162055, 1407: 162056, 1408: 162057, 1409: 162058, 1410: 162059, 1411: 162060, 1412: 162061, 1413: 162062, 1414: 162063, 1415: 162064, 1416: 162065, 1417: 162066, 1418: 162067, 1419: 162068, 1420: 162069, 1421: 162070, 1422: 162071, 1423: 162072, 1424: 162073, 1425: 162074, 1426: 162075, 1427: 162076, 1428: 162077, 1429: 162078, 1430: 162079, 1431: 162080, 1432: 162081, 1433: 162082, 1434: 162083, 1435: 162084, 1436: 162085, 1437: 162086, 1438: 162087, 1439: 162088, 1440: 162089, 1441: 162090, 1442: 162091, 1443: 162092, 1444: 162093, 1445: 162094, 1446: 162095, 1447: 162096, 1448: 162097, 1449: 162098, 1450: 162099, 1451: 162100, 1452: 162101, 1455: 162102, 1456: 162103, 1457: 162104, 1458: 162105, 1459: 162106, 1461: 162107, 1464: 162108, 1465: 162109, 1466: 162110, 1467: 162111, 1468: 162112, 1469: 162113, 1472: 162114, 1473: 162115, 1474: 162116
                }




    map_get = {352:165745}#{1: 152685, 259: 152686, 774: 152688, 1409: 152719, 44: 152695, 14: 152689, 273: 152690, 147: 152721, 661: 152722,
     # 27: 152691, 1440: 152723, 35: 152692, 37: 152693, 169: 152724, 172: 152725, 45: 152696, 174: 152726, 47: 152698,
     # 49: 152700, 50: 152701, 51: 152702, 52: 152703, 53: 152704, 55: 152706, 327: 152707, 332: 152708, 204: 152727,
     # 210: 152728, 619: 152709, 114: 152710, 115: 152711, 118: 152712, 1402: 152713, 1403: 152714, 1404: 152715,
     # 1405: 152716, 1406: 152717, 1407: 152718}

    # {1: 1, 2: 2, 3: 3, 4: 4, 5: 5, 6: 6, 7: 7, 8: 8, 9: 9, 10: 10, 11: 11, 12: 12, 13: 13, 14: 14, 15: 15, 16: 16, 17: 17, 18: 18, 19: 19, 20: 20, 21: 21, 22: 22, 23: 23, 24: 24, 25: 25, 26: 26, 27: 27, 28: 28, 29: 29, 30: 30, 31: 31, 32: 32, 33: 33, 34: 34, 35: 35, 36: 36, 37: 37, 38: 38, 39: 39, 40: 40, 41: 41, 42: 42, 43: 43, 44: 44, 45: 45, 46: 46, 47: 47, 48: 48, 49: 49, 50: 50, 51: 51, 52: 52, 53: 53, 54: 54, 55: 55, 56: 56, 57: 57, 58: 58, 59: 59, 60: 60, 61: 61, 62: 62, 63: 63, 64: 64, 65: 65, 67: 66, 68: 67, 70: 68, 71: 69, 72: 70, 73: 71, 74: 72, 75: 73, 76: 74, 77: 75, 78: 76, 79: 77, 80: 78, 81: 79, 82: 80, 83: 81, 84: 82, 85: 83, 86: 84, 87: 85, 88: 86, 89: 87, 90: 88, 91: 89, 92: 90, 93: 91, 94: 92, 95: 93, 96: 94, 97: 95, 98: 96, 99: 97, 100: 98, 101: 99, 102: 100, 103: 101, 104: 102, 105: 103, 106: 104, 107: 105, 108: 106, 109: 107, 110: 108, 111: 109, 112: 110, 113: 111, 114: 112, 115: 113, 116: 114, 117: 115, 118: 116, 119: 117, 120: 118, 121: 119, 122: 120, 123: 121, 124: 122, 125: 123, 126: 124, 127: 125, 128: 126, 129: 127, 130: 128, 131: 129, 132: 130, 133: 131, 134: 132, 135: 133, 136: 134, 137: 135, 138: 136, 139: 137, 140: 138, 141: 139, 142: 140, 143: 141, 144: 142, 145: 143, 146: 144, 147: 145, 148: 146, 149: 147, 150: 148, 151: 149, 152: 150, 153: 151, 154: 152, 155: 153, 156: 154, 157: 155, 158: 156, 159: 157, 160: 158, 161: 159, 162: 160, 163: 161, 164: 162, 165: 163, 166: 164, 167: 165, 168: 166, 169: 167, 170: 168, 171: 169, 172: 170, 173: 171, 174: 172, 175: 173, 176: 174, 177: 175, 178: 176, 179: 177, 180: 178, 181: 179, 182: 180, 183: 181, 184: 182, 185: 183, 186: 184, 187: 185, 188: 186, 189: 187, 190: 188, 191: 189, 192: 190, 193: 191, 194: 192, 195: 193, 196: 194, 197: 195, 198: 196, 199: 197, 200: 198, 201: 199, 202: 200, 203: 201, 204: 202, 206: 203, 207: 204, 208: 205, 209: 206, 210: 207, 211: 208, 212: 209, 213: 210, 214: 211, 215: 212, 216: 213, 217: 214, 218: 215, 219: 216, 220: 217, 221: 218, 222: 219, 223: 220, 224: 221, 225: 222, 226: 223, 227: 224, 228: 225, 229: 226, 230: 227, 231: 228, 232: 229, 233: 230, 234: 231, 235: 232, 236: 233, 237: 234, 238: 235, 239: 236, 240: 237, 241: 238, 242: 239, 243: 240, 244: 241, 245: 242, 246: 243, 247: 244, 248: 245, 249: 246, 250: 247, 251: 248, 252: 249, 253: 250, 254: 251, 255: 252, 256: 253, 257: 254, 258: 255, 259: 256, 260: 257, 261: 258, 262: 259, 263: 260, 264: 261, 265: 262, 266: 263, 267: 264, 268: 265, 269: 266, 270: 267, 271: 268, 272: 269, 273: 270, 274: 271, 275: 272, 276: 273, 277: 274, 278: 275, 279: 276, 280: 277, 281: 278, 282: 279, 283: 280, 284: 281, 285: 282, 286: 283, 287: 284, 288: 285, 289: 286, 290: 287, 291: 288, 292: 289, 293: 290, 294: 291, 295: 292, 296: 293, 297: 294, 298: 295, 299: 296, 300: 297, 301: 298, 302: 299, 303: 300, 304: 301, 305: 302, 306: 303, 307: 304, 308: 305, 309: 306, 310: 307, 311: 308, 312: 309, 313: 310, 314: 311, 315: 312, 316: 313, 317: 314, 318: 315, 319: 316, 320: 317, 321: 318, 322: 319, 323: 320, 324: 321, 325: 322, 326: 323, 327: 324, 328: 325, 329: 326, 330: 327, 331: 328, 332: 329, 333: 330, 334: 331, 335: 332, 336: 333, 337: 334, 338: 335, 339: 336, 340: 337, 341: 338, 342: 339, 343: 340, 344: 341, 345: 342, 346: 343, 347: 344, 348: 345, 349: 346, 350: 347, 351: 348, 352: 349, 353: 350, 354: 351, 355: 352, 356: 353, 357: 354, 358: 355, 359: 356, 360: 357, 361: 358, 362: 359, 363: 360, 364: 361, 365: 362, 366: 363, 367: 364, 368: 365, 369: 366, 370: 367, 371: 368, 372: 369, 373: 370, 374: 371, 375: 372, 376: 373, 377: 374, 378: 375, 379: 376, 380: 377, 381: 378, 382: 379, 383: 380, 384: 381, 385: 382, 386: 383, 387: 384, 388: 385, 389: 386, 390: 387, 391: 388, 392: 389, 393: 390, 394: 391, 395: 392, 396: 393, 397: 394, 398: 395, 399: 396, 400: 397, 401: 398, 402: 399, 403: 400, 404: 401, 405: 402, 406: 403, 407: 404, 408: 405, 409: 406, 410: 407, 411: 408, 412: 409, 413: 410, 414: 411, 415: 412, 416: 413, 417: 414, 418: 415, 419: 416, 420: 417, 421: 418, 422: 419, 423: 420, 424: 421, 425: 422, 426: 423, 427: 424, 428: 425, 429: 426, 430: 427, 431: 428, 432: 429, 433: 430, 434: 431, 435: 432, 436: 433, 437: 434, 438: 435, 439: 436, 440: 437, 441: 438, 442: 439, 443: 440, 444: 441, 445: 442, 446: 443, 447: 444, 448: 445, 449: 446, 450: 447, 451: 448, 452: 449, 453: 450, 454: 451, 455: 452, 456: 453, 457: 454, 458: 455, 459: 456, 460: 457, 461: 458, 462: 459, 463: 460, 464: 461, 465: 462, 466: 463, 467: 464, 468: 465, 469: 466, 470: 467, 471: 468, 472: 469, 473: 470, 474: 471, 475: 472, 476: 473, 477: 474, 478: 475, 479: 476, 480: 477, 481: 478, 482: 479, 483: 480, 484: 481, 485: 482, 486: 483, 487: 484, 488: 485, 489: 486, 490: 487, 491: 488, 492: 489, 493: 490, 494: 491, 495: 492, 496: 493, 497: 494, 498: 495, 499: 496, 500: 497, 501: 498, 502: 499, 503: 500, 504: 501, 505: 502, 506: 503, 507: 504, 508: 505, 509: 506, 510: 507, 511: 508, 512: 509, 513: 510, 514: 511, 515: 512, 516: 513, 517: 514, 518: 515, 519: 516, 520: 517, 521: 518, 522: 519, 523: 520, 524: 521, 525: 522, 526: 523, 527: 524, 528: 525, 529: 526, 530: 527, 531: 528, 532: 529, 533: 530, 534: 531, 535: 532, 536: 533, 537: 534, 538: 535, 539: 536, 540: 537, 541: 538, 542: 539, 543: 540, 544: 541, 545: 542, 546: 543, 547: 544, 548: 545, 549: 546, 550: 547, 551: 548, 552: 549, 553: 550, 554: 551, 555: 552, 556: 553, 557: 554, 558: 555, 559: 556, 560: 557, 561: 558, 562: 559, 563: 560, 564: 561, 565: 562, 566: 563, 567: 564, 568: 565, 569: 566, 570: 567, 571: 568, 572: 569, 573: 570, 574: 571, 575: 572, 576: 573, 577: 574, 579: 575, 580: 576, 581: 577, 582: 578, 583: 579, 584: 580, 585: 581, 586: 582, 587: 583, 588: 584, 589: 585, 590: 586, 591: 587, 592: 588, 593: 589, 594: 590, 595: 591, 596: 592, 597: 593, 598: 594, 599: 595, 600: 596, 601: 597, 602: 598, 603: 599, 604: 600, 605: 601, 606: 602, 607: 603, 608: 604, 609: 605, 610: 606, 611: 607, 612: 608, 613: 609, 614: 610, 615: 611, 616: 612, 617: 613, 618: 614, 619: 615, 620: 616, 621: 617, 622: 618, 623: 619, 624: 620, 625: 621, 626: 622, 628: 623, 629: 624, 630: 625, 631: 626, 632: 627, 633: 628, 634: 629, 635: 630, 636: 631, 637: 632, 638: 633, 639: 634, 640: 635, 641: 636, 642: 637, 643: 638, 644: 639, 645: 640, 646: 641, 647: 642, 648: 643, 649: 644, 650: 645, 651: 646, 652: 647, 653: 648, 654: 649, 655: 650, 656: 651, 657: 652, 658: 653, 659: 654, 660: 655, 661: 656, 662: 657, 663: 658, 664: 659, 665: 660, 666: 661, 667: 662, 668: 663, 669: 664, 670: 665, 671: 666, 672: 667, 673: 668, 674: 669, 675: 670, 676: 671, 677: 672, 678: 673, 679: 674, 680: 675, 681: 676, 682: 677, 683: 678, 684: 679, 685: 680, 686: 681, 687: 682, 688: 683, 689: 684, 690: 685, 691: 686, 692: 687, 693: 688, 694: 689, 695: 690, 696: 691, 697: 692, 698: 693, 699: 694, 700: 695, 701: 696, 702: 697, 703: 698, 704: 699, 705: 700, 706: 701, 707: 702, 708: 703, 709: 704, 710: 705, 711: 706, 712: 707, 713: 708, 714: 709, 715: 710, 716: 711, 717: 712, 718: 713, 719: 714, 720: 715, 721: 716, 722: 717, 723: 718, 724: 719, 725: 720, 726: 721, 727: 722, 728: 723, 729: 724, 730: 725, 731: 726, 732: 727, 733: 728, 734: 729, 735: 730, 736: 731, 737: 732, 738: 733, 739: 734, 740: 735, 741: 736, 742: 737, 743: 738, 744: 739, 745: 740, 746: 741, 747: 742, 748: 743, 749: 744, 750: 745, 751: 746, 752: 747, 753: 748, 754: 749, 755: 750, 756: 751, 757: 752, 758: 753, 759: 754, 760: 755, 761: 756, 762: 757, 763: 758, 764: 759, 765: 760, 766: 761, 767: 762, 768: 763, 769: 764, 770: 765, 771: 766, 772: 767, 773: 768, 774: 769, 775: 770, 776: 771, 777: 772, 778: 773, 779: 774, 780: 775, 781: 776, 782: 777, 783: 778, 784: 779, 785: 780, 786: 781, 787: 782, 788: 783, 789: 784, 790: 785, 791: 786, 792: 787, 793: 788, 794: 789, 795: 790, 796: 791, 797: 792, 798: 793, 799: 794, 800: 795, 801: 796, 802: 797, 803: 798, 804: 799, 805: 800, 806: 801, 807: 802, 808: 803, 809: 804, 810: 805, 811: 806, 812: 807, 813: 808, 814: 809, 815: 810, 816: 811, 817: 812, 818: 813, 819: 814, 820: 815, 821: 816, 822: 817, 823: 818, 824: 819, 825: 820, 826: 821, 827: 822, 828: 823, 829: 824, 830: 825, 831: 826, 832: 827, 833: 828, 834: 829, 835: 830, 836: 831, 837: 832, 838: 833, 839: 834, 840: 835, 841: 836, 842: 837, 843: 838, 844: 839, 845: 840, 846: 841, 847: 842, 848: 843, 849: 844, 850: 845, 851: 846, 852: 847, 853: 848, 854: 849, 855: 850, 856: 851, 857: 852, 858: 853, 859: 854, 860: 855, 861: 856, 862: 857, 863: 858, 864: 859, 865: 860, 866: 861, 867: 862, 868: 863, 869: 864, 870: 865, 871: 866, 872: 867, 873: 868, 874: 869, 875: 870, 876: 871, 877: 872, 878: 873, 879: 874, 880: 875, 881: 876, 882: 877, 883: 878, 884: 879, 885: 880, 886: 881, 887: 882, 888: 883, 889: 884, 890: 885, 891: 886, 892: 887, 893: 888, 894: 889, 895: 890, 896: 891, 897: 892, 898: 893, 899: 894, 900: 895, 901: 896, 902: 897, 903: 898, 904: 899, 905: 900, 906: 901, 907: 902, 908: 903, 909: 904, 910: 905, 911: 906, 912: 907, 913: 908, 914: 909, 915: 910, 916: 911, 917: 912, 918: 913, 919: 914, 920: 915, 921: 916, 922: 917, 923: 918, 924: 919, 925: 920, 926: 921, 927: 922, 928: 923, 929: 924, 930: 925, 931: 926, 932: 927, 933: 928, 934: 929, 935: 930, 936: 931, 937: 932, 938: 933, 939: 934, 940: 935, 941: 936, 942: 937, 943: 938, 944: 939, 945: 940, 946: 941, 947: 942, 948: 943, 949: 944, 950: 945, 951: 946, 952: 947, 953: 948, 954: 949, 955: 950, 956: 951, 957: 952, 958: 953, 959: 954, 960: 955, 961: 956, 962: 957, 963: 958, 964: 959, 965: 960, 966: 961, 967: 962, 968: 963, 969: 964, 970: 965, 971: 966, 972: 967, 973: 968, 974: 969, 975: 970, 976: 971, 977: 972, 978: 973, 979: 974, 980: 975, 981: 976, 982: 977, 983: 978, 984: 979, 985: 980, 986: 981, 988: 982, 989: 983, 990: 984, 991: 985, 992: 986, 993: 987, 994: 988, 995: 989, 996: 990, 997: 991, 998: 992, 999: 993, 1000: 994, 1001: 995, 1002: 996, 1003: 997, 1004: 998, 1005: 999, 1006: 1000, 1007: 1001, 1008: 1002, 1009: 1003, 1010: 1004, 1011: 1005, 1012: 1006, 1013: 1007, 1014: 1008, 1015: 1009, 1016: 1010, 1017: 1011, 1018: 1012, 1019: 1013, 1020: 1014, 1021: 1015, 1022: 1016, 1023: 1017, 1024: 1018, 1025: 1019, 1026: 1020, 1027: 1021, 1028: 1022, 1029: 1023, 1030: 1024, 1031: 1025, 1032: 1026, 1033: 1027, 1034: 1028, 1035: 1029, 1036: 1030, 1037: 1031, 1038: 1032, 1039: 1033, 1040: 1034, 1041: 1035, 1042: 1036, 1043: 1037, 1044: 1038, 1045: 1039, 1046: 1040, 1047: 1041, 1048: 1042, 1049: 1043, 1050: 1044, 1051: 1045, 1052: 1046, 1053: 1047, 1054: 1048, 1055: 1049, 1056: 1050, 1057: 1051, 1058: 1052, 1059: 1053, 1060: 1054, 1061: 1055, 1062: 1056, 1063: 1057, 1064: 1058, 1065: 1059, 1066: 1060, 1067: 1061, 1068: 1062, 1069: 1063, 1070: 1064, 1071: 1065, 1072: 1066, 1073: 1067, 1074: 1068, 1075: 1069, 1076: 1070, 1077: 1071, 1078: 1072, 1079: 1073, 1080: 1074, 1081: 1075, 1082: 1076, 1083: 1077, 1084: 1078, 1085: 1079, 1086: 1080, 1087: 1081, 1088: 1082, 1089: 1083, 1090: 1084, 1091: 1085, 1092: 1086, 1093: 1087, 1094: 1088, 1095: 1089, 1096: 1090, 1097: 1091, 1098: 1092, 1099: 1093, 1100: 1094, 1101: 1095, 1102: 1096, 1103: 1097, 1104: 1098, 1105: 1099, 1106: 1100, 1107: 1101, 1108: 1102, 1109: 1103, 1110: 1104, 1111: 1105, 1112: 1106, 1113: 1107, 1114: 1108, 1115: 1109, 1116: 1110, 1117: 1111, 1118: 1112, 1119: 1113, 1120: 1114, 1121: 1115, 1122: 1116, 1123: 1117, 1124: 1118, 1125: 1119, 1126: 1120, 1127: 1121, 1128: 1122, 1129: 1123, 1130: 1124, 1131: 1125, 1132: 1126, 1133: 1127, 1134: 1128, 1135: 1129, 1136: 1130, 1137: 1131, 1138: 1132, 1139: 1133, 1140: 1134, 1141: 1135, 1142: 1136, 1143: 1137, 1144: 1138, 1145: 1139, 1146: 1140, 1147: 1141, 1148: 1142, 1149: 1143, 1150: 1144, 1151: 1145, 1152: 1146, 1153: 1147, 1154: 1148, 1155: 1149, 1156: 1150, 1157: 1151, 1158: 1152, 1159: 1153, 1160: 1154, 1161: 1155, 1162: 1156, 1163: 1157, 1164: 1460, 1165: 1159, 1166: 1160, 1167: 1161, 1168: 1162, 1169: 1163, 1170: 1164, 1171: 1165, 1172: 1166, 1173: 1167, 1174: 1168, 1175: 1169, 1176: 1170, 1177: 1171, 1178: 1172, 1179: 1173, 1180: 1174, 1181: 1175, 1182: 1176, 1183: 1177, 1184: 1178, 1185: 1179, 1186: 1180, 1187: 1181, 1188: 1182, 1189: 1183, 1190: 1184, 1191: 1185, 1192: 1186, 1193: 1187, 1194: 1188, 1195: 1189, 1196: 1190, 1197: 1191, 1198: 1192, 1199: 1193, 1200: 1194, 1201: 1195, 1202: 1196, 1203: 1197, 1204: 1198, 1205: 1199, 1206: 1200, 1207: 1201, 1208: 1202, 1209: 1203, 1210: 1204, 1211: 1205, 1212: 1206, 1213: 1207, 1214: 1208, 1215: 1209, 1216: 1210, 1217: 1211, 1218: 1212, 1219: 1213, 1220: 1214, 1221: 1215, 1222: 1216, 1223: 1217, 1224: 1218, 1225: 1219, 1226: 1220, 1227: 1221, 1228: 1222, 1229: 1223, 1230: 1224, 1231: 1225, 1232: 1226, 1233: 1227, 1234: 1228, 1235: 1229, 1236: 1230, 1237: 1231, 1238: 1232, 1239: 1233, 1240: 1234, 1241: 1235, 1243: 1236, 1244: 1237, 1245: 1238, 1246: 1239, 1247: 1240, 1248: 1241, 1249: 1242, 1250: 1243, 1251: 1244, 1252: 1245, 1253: 1246, 1254: 1247, 1255: 1248, 1256: 1249, 1257: 1250, 1258: 1251, 1259: 1252, 1260: 1253, 1261: 1254, 1262: 1255, 1263: 1256, 1264: 1257, 1265: 1258, 1266: 1259, 1267: 1260, 1268: 1261, 1269: 1262, 1270: 1263, 1271: 1264, 1272: 1265, 1273: 1266, 1274: 1267, 1275: 1268, 1276: 1269, 1277: 1270, 1278: 1271, 1279: 1272, 1280: 1273, 1281: 1274, 1282: 1275, 1283: 1276, 1284: 1277, 1285: 1278, 1286: 1279, 1287: 1280, 1288: 1281, 1289: 1282, 1290: 1283, 1291: 1284, 1292: 1285, 1293: 1286, 1294: 1287, 1295: 1288, 1296: 1289, 1297: 1290, 1298: 1291, 1299: 1292, 1300: 1293, 1301: 1294, 1302: 1295, 1303: 1296, 1304: 1297, 1305: 1298, 1306: 1299, 1307: 1300, 1308: 1301, 1309: 1302, 1310: 1303, 1311: 1304, 1312: 1305, 1313: 1306, 1314: 1307, 1315: 1308, 1316: 1309, 1317: 1310, 1318: 1311, 1319: 1312, 1320: 1313, 1321: 1314, 1322: 1315, 1323: 1316, 1324: 1317, 1325: 1318, 1326: 1319, 1327: 1320, 1328: 1321, 1329: 1322, 1330: 1323, 1331: 1324, 1332: 1325, 1333: 1326, 1334: 1327, 1335: 1328, 1336: 1329, 1337: 1330, 1338: 1331, 1339: 1332, 1340: 1333, 1341: 1334, 1342: 1335, 1343: 1336, 1344: 1337, 1345: 1338, 1346: 1339, 1348: 1340, 1349: 1341, 1350: 1342, 1351: 1343, 1352: 1344, 1353: 1345, 1354: 1346, 1355: 1347, 1356: 1348, 1357: 1349, 1358: 1350, 1359: 1351, 1360: 1352, 1361: 1353, 1362: 1354, 1363: 1355, 1364: 1356, 1365: 1357, 1366: 1358, 1367: 1359, 1368: 1360, 1369: 1361, 1370: 1362, 1371: 1363, 1372: 1364, 1373: 1365, 1374: 1366, 1375: 1367, 1376: 1368, 1377: 1369, 1378: 1370, 1379: 1371, 1380: 1372, 1381: 1373, 1382: 1374, 1383: 1375, 1384: 1376, 1385: 1377, 1386: 1378, 1387: 1379, 1388: 1380, 1389: 1381, 1390: 1382, 1391: 1383, 1392: 1384, 1393: 1385, 1394: 1386, 1395: 1387, 1396: 1388, 1397: 1389, 1398: 1390, 1399: 1391, 1400: 1392, 1401: 1393, 1402: 1394, 1403: 1395, 1404: 1396, 1405: 1397, 1406: 1398, 1407: 1399, 1408: 1400, 1409: 1401, 1410: 1402, 1411: 1403, 1412: 1404, 1413: 1405, 1414: 1406, 1415: 1407, 1416: 1408, 1417: 1409, 1418: 1410, 1419: 1411, 1420: 1412, 1421: 1413, 1422: 1414, 1423: 1415, 1424: 1416, 1425: 1417, 1426: 1418, 1427: 1419, 1428: 1420, 1429: 1421, 1430: 1422, 1431: 1423, 1432: 1424, 1433: 1425, 1434: 1426, 1435: 1427, 1436: 1428, 1437: 1429, 1438: 1430, 1439: 1431, 1440: 1432, 1441: 1433, 1442: 1434, 1443: 1435, 1444: 1436, 1445: 1437, 1446: 1438, 1447: 1439, 1448: 1440, 1449: 1441, 1450: 1442, 1451: 1443, 1452: 1444, 1455: 1445, 1456: 1446, 1457: 1447, 1458: 1448, 1459: 1449, 1461: 1450, 1464: 1451, 1465: 1452, 1466: 1453, 1467: 1454, 1468: 1455, 1469: 1456, 1472: 1457, 1473: 1458, 1474: 1459
               #}

    # ssn_sheets = [1409, 259, 774, 44, 142, 147, 174, 27, 1440, 35, 37, 169, 172, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 246, 327, 332, 204, 1407, 619, 114, 115, 118, 1402, 1403, 1404, 1405, 1406, 661]

    # ssn_sheets = [76, 594, 603, 1117, 1119, 99, 101, 956, 619, 620, 109, 1136, 118, 119, 120, 1145, 638, 1153, 648, 1164, 662, 663, 1220, 160, 677, 1195, 607, 689, 1204, 181, 182, 183, 696, 187, 191, 704, 708, 734, 737, 230, 1263, 755, 757, 759, 762, 259, 261, 784, 797, 289, 809, 298, 814, 816, 1416, 314, 829, 838, 857, 353, 354, 365, 879, 368, 884, 1404, 392, 906, 908, 1432, 410, 411, 1439, 1442, 923, 423, 425, 426, 941, 1464, 1465, 1468, 957, 1473, 1474, 964, 1478, 463, 250, 479, 482, 1015]

    # sheets = [151214, 151293, 151343, 151346, 151348, 151378, 151432, 151500, 151505, 151794, 151948, 152589, 152590, 152591, 152592, 152593, 152594, 152728, 152729, 152730, 152731, 152732, 152733, 152734, 152735, 152736, 152737, 152738, 152739, 152825, 152928, 151322, 151204, 151289, 151290, 151835, 152627, 152596]
    sheets = [153054, 153055, 153056, 153057, 153058, 153059, 153060, 153061, 153062, 153063, 153064, 153065, 153066, 153067, 153068, 153069, 153070, 153071, 153072, 153073, 153074, 153075, 153076, 153077, 153078, 153079, 153080, 153081, 153082, 153083, 153084, 153085, 153086, 153087, 153088, 153089, 153090, 153091, 153092, 153093, 153094, 153095, 153096, 153097, 153098]



    bi = [1, 259, 204, 774, 1409, 172, 332, 14, 115, 273, 210, 147, 661, 27, 1402, 1440, 35, 37, 169, 327, 44, 45, 174, 47, 619, 49, 50, 51, 52, 53, 118, 55, 114, 1403, 1404, 1405, 1406, 1407]


    for sheet_ssn in [352]: # bi #[35, 246, 169, 45, 142, 48, 115, 51, 52, 174, 118, 27, 53]: #range(418,1478):  # id or ssn_sheet number
        post_btween_sandboxes(ssn=sheet_ssn, map_ssn_url_get=map_get, map_ssn_url_post=map_post, pdf_action='add', new_post=False)
    # for sheet_id in sheets:
    #     post_btween_sandboxes(id=sheet_id) #, new_post=True)#map_ssn_url_get=map_get, map_ssn_url_post=map_post, new_post=True)

    # tochange = db.sheets.find({"id":1158})
    # for olddoc in tochange:
    #     newdoc = db.sheets.find_one({"id":1460})
    #     newdoc = change_sheet(newdoc, add_tags=[],
    #                           del_tags=["UI", 'int_tag', 'Hebrew Sheet', 'Merged', 'Bilingual', 'Edited', 'Linked'],
    #                           pdf_action='add')
    #     # del newdoc['_id']
    #     db.sheets.update({'_id': olddoc["_id"]}, newdoc)
    # for olddoc in tochange:
    #     newdoc = change_sheet(olddoc, add_tags=[], del_tags=["UI", 'int_tag', 'Hebrew Sheet', 'Merged', 'Bilingual', 'Edited', 'Linked'], pdf_action='add')
    #     db.sheets.update({'_id': olddoc["_id"]}, newdoc)


#done: [152685, 152686, 152687, 152688, 152689, 152690, 152691, 152692, 152693, 152694]
# [152695, 152696, 152697, 152698, 152699, 152700, 152701, 152702, 152703, 152704, 152705, 152706, 152707, 152708, 152709, 152710, 152712, 152713, 152714, 152715, 152716, 152717, 152718, 152720, 152721, 152722, 152723, 152724, 152725, 152726, 152727, 152728, 152730, 152731, 152733, 152734, 152738, 152739, 152740, 152741, 152742, 152743, 152744, 152745, 152746, 152747, 152748, 152749, 152750, 152751, 152752, 152753, 152754, 152755, 152756, 152757, 152758, 152759, 152760, 152761, 152762, 152763, 152764, 152765, 152766, 152767, 152768, 152769, 152770, 152771, 152772, 152773, 152774, 152775, 152776, 152777, 152778, 152779, 152780, 152781, 152782, 152783, 152784, 152785, 152786, 152787, 152788, 152789, 152790, 152791]
# [152792, 152793, 152794, 152795, 152796, 152798, 152799, 152801, 152802, 152803, 152804, 152805, 152806, 152807, 152808, 152809, 152810, 152811, 152812, 152813, 152814, 152815, 152816, 152817, 152818, 152819, 152820, 152821, 152822, 152823, 152825, 152826, 152827, 152828, 152829, 152830, 152831, 152832, 152833, 152834, 152835, 152836, 152837, 152838, 152839, 152840, 152841, 152842, 152843, 152844, 152845, 152846, 152847, 152848, 152849, 152850, 152852, 152853, 152854, 152855, 152857, 152858, 152859, 152860, 152861, 152862, 152863, 152864, 152865, 152866, 152867, 152868, 152869, 152870, 152871, 152872, 152873, 152874, 152875, 152876, 152877, 152878, 152879, 152880, 152881, 152882, 152883, 152884, 152885, 152886, 152887, 152888, 152889, 152890, 152891, 152892, 152893, 152894, 152895, 152896]
# [152897, 152898, 152899, 152900, 152901, 152902, 152903, 152904, 152905, 152906, 152907, 152908, 152909, 152910, 152911, 152912, 152913, 152914, 152915, 152916, 152917, 152918, 152919, 152920, 152921, 152922, 152923, 152924, 152925, 152926, 152928, 152929, 152930, 152931, 152932, 152933, 152934, 152935, 152936, 152937, 152938, 152939, 152940, 152941, 152942, 152943, 152944, 152945, 152946, 152947, 152948, 152949, 152950, 152951, 152952, 152953, 152954, 152955, 152956, 152957, 152958, 152959, 152960, 152961, 152962, 152963, 152964, 152965, 152966, 152967, 152968, 152969, 152970, 152971, 152972, 152973, 152974, 152975, 152976, 152978, 152979, 152980, 152981, 152982, 152983, 152984, 152985, 152986, 152987, 152988, 152989, 152990, 152991, 152992, 152993, 152994, 152995, 152996, 152997, 152998, 152999, 153000, 153001, 153002, 153003, 153004, 153005, 153006, 153007, 153008, 153009, 153010, 153011, 153012, 153013, 153014, 153015, 153016, 153017, 153018, 153019, 153020, 153021, 153022, 153023, 153024, 153025, 153026, 153027, 153028, 153029, 153030, 153031, 153032,153033, 153034, 153035, 153036, 153037, 153038, 153039, 153040, 153041, 153042, 153043, 153044, 153045, 153046, 153047, 153048, 153049, 153050, 153051, 153052, 153053,]
# Delete duplicates
# for sheet_id in range(151200, 151843):
#     sheets = db.sheets.count_documents({'id': sheet_id})
#     if sheets > 1:
#         print sheet_id
#         cursor = db.sheets.find({'id': sheet_id})
#         for s in cursor:
#             db.sheets.remove(s)
#             break