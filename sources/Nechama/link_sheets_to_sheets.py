#encoding=utf-8

import django
django.setup()
from sefaria.model import *
from sefaria.system.database import db
import re
from sources.local_settings import *
from sources.functions import post_sheet, http_request
from post_sheet import *
#
# GET_SERVER = "http://ravnataf.sandbox.sefaria.org" #"http://localhost:8000" #"https://www.sefaria.org"#
# POST_SERVER = "http://ravnataf.sandbox.sefaria.org"#"http://localhost:8000" #"http://ravnataf.sandbox.sefaria.org" #"https://www.sefaria.org"#

GET_SERVER = "https://www.sefaria.org"
POST_SERVER = "https://www.sefaria.org"


MAP_POST = {1: 160441, 2: 160442, 3: 160443, 4: 160444, 5: 160445, 6: 160446, 7: 160447, 8: 160448, 9: 160449, 10: 160450, 11: 160451, 12: 160452, 13: 160453, 14: 160454, 15: 160455, 16: 160456, 17: 160457, 18: 160458, 19: 160459, 20: 160460, 21: 160461, 22: 160462, 23: 160463, 24: 160464, 25: 160465, 26: 160466, 27: 162336, 28: 160467, 29: 160468, 30: 160469, 31: 160470, 32: 160471, 33: 160472, 34: 160473, 35: 162325, 36: 160474, 37: 160475, 38: 160476, 39: 160477, 40: 160478, 41: 160479, 42: 160480, 43: 160481, 44: 160482, 45: 162328, 46: 160483, 47: 160484, 48: 162330, 49: 160485, 50: 160486, 51: 162332, 52: 162333, 53: 162337, 54: 160487, 55: 160488, 56: 160489, 57: 160490, 58: 160491, 59: 160492, 60: 160493, 61: 160494, 62: 160495, 63: 160496, 64: 160497, 65: 160498, 67: 160499, 68: 160500, 70: 160501, 71: 160502, 72: 160503, 73: 160504, 74: 160505, 75: 160506, 76: 160507, 77: 160508, 78: 160509, 79: 160510, 80: 160511, 81: 160512, 82: 160513, 83: 160514, 84: 160515, 85: 160516, 86: 160517, 87: 160518, 88: 160519, 89: 160520, 90: 160521, 91: 160522, 92: 160523, 93: 160524, 94: 160525, 95: 160526, 96: 160527, 97: 160528, 98: 160529, 99: 160530, 100: 160531, 101: 160532, 102: 160533, 103: 160534, 104: 160535, 105: 160536, 106: 160537, 107: 160538, 108: 160539, 109: 160540, 110: 160542, 111: 160543, 112: 160544, 113: 160545, 114: 160546, 115: 162331, 116: 160547, 117: 160548, 118: 162335, 119: 160549, 120: 160550, 121: 160551, 122: 160552, 123: 160553, 124: 160554, 125: 160555, 126: 160556, 127: 160557, 128: 160558, 129: 160559, 130: 160560, 131: 160561, 132: 160562, 133: 160563, 134: 160564, 135: 160565, 136: 160566, 137: 160567, 138: 160568, 139: 160569, 140: 160570, 141: 160571, 142: 162329, 143: 160572, 144: 160573, 145: 160574, 146: 160575, 147: 160576, 148: 160577, 149: 160578, 150: 160579, 151: 160580, 152: 160581, 153: 160582, 154: 160583, 155: 160584, 156: 160585, 157: 160586, 158: 160587, 159: 160588, 160: 160589, 161: 160590, 162: 160591, 163: 160592, 164: 160593, 165: 160594, 166: 160595, 167: 160596, 168: 160597, 169: 162327, 170: 160598, 171: 160599, 172: 160600, 173: 160601, 174: 162334, 175: 160602, 176: 160603, 177: 160604, 178: 160605, 179: 160606, 180: 160607, 181: 160608, 182: 160609, 183: 160610, 184: 160611, 185: 160612, 186: 160613, 187: 160614, 188: 160615, 189: 160616, 190: 160617, 191: 160618, 192: 160619, 193: 160620, 194: 160621, 195: 160622, 196: 160623, 197: 160624, 198: 160625, 199: 160626, 200: 160627, 201: 160628, 202: 160629, 203: 160630, 204: 160631, 206: 160632, 207: 160633, 208: 160634, 209: 160635, 210: 160636, 211: 160637, 212: 160638, 213: 160639, 214: 160640, 215: 160641, 216: 160642, 217: 160643, 218: 160644, 219: 160645, 220: 160646, 221: 160647, 222: 160648, 223: 160649, 224: 160650, 225: 160651, 226: 160652, 227: 160653, 228: 160654, 229: 160655, 230: 160656, 231: 160657, 232: 160658, 233: 160659, 234: 160660, 235: 160661, 236: 160662, 237: 160663, 238: 160664, 239: 160665, 240: 160666, 241: 160667, 242: 160668, 243: 160669, 244: 160670, 245: 160671, 246: 162326, 247: 160672, 248: 160673, 249: 160674, 250: 160675, 251: 160676, 252: 160677, 253: 160678, 254: 160679, 255: 160680, 256: 160681, 257: 160682, 258: 160683, 259: 160684, 260: 160685, 261: 160686, 262: 160687, 263: 160688, 264: 160689, 265: 160690, 266: 160691, 267: 160692, 268: 160693, 269: 160694, 270: 160695, 271: 160696, 272: 160697, 273: 160698, 274: 160699, 275: 160700, 276: 160701, 277: 160702, 278: 160703, 279: 160704, 280: 160705, 281: 160706, 282: 160707, 283: 160708, 284: 160709, 285: 160710, 286: 160711, 287: 160712, 288: 160713, 289: 160714, 290: 160715, 291: 160716, 292: 160717, 293: 160718, 294: 160719, 295: 160720, 297: 160721, 298: 160722, 299: 160723, 300: 160724, 301: 160725, 302: 160726, 303: 160727, 304: 160728, 305: 160729, 306: 160730, 307: 160731, 308: 160732, 309: 160733, 310: 160734, 311: 160735, 312: 160736, 313: 160737, 314: 160738, 315: 160739, 316: 160740, 317: 160741, 318: 160746, 319: 160747, 320: 160748, 321: 160749, 322: 160750, 323: 160751, 324: 160752, 325: 160753, 326: 160754, 327: 160755, 328: 160756, 329: 160757, 330: 160758, 331: 160759, 332: 160760, 333: 160761, 334: 160762, 335: 160763, 336: 160764, 337: 160765, 338: 160766, 339: 160767, 340: 160768, 341: 160769, 342: 160770, 343: 160771, 344: 160772, 345: 160773, 346: 160774, 347: 160775, 348: 160776, 349: 160777, 350: 160778, 351: 160779, 352: 160785, 353: 160786, 354: 160787, 355: 160788, 356: 160789, 357: 160790, 358: 160791, 359: 160792, 360: 160793, 361: 160794, 362: 160795, 363: 160796, 364: 160797, 365: 160798, 366: 160799, 367: 160800, 368: 160801, 369: 160802, 370: 160803, 371: 160804, 372: 160805, 373: 160817, 374: 160818, 375: 160819, 376: 160820, 377: 160822, 378: 160823, 379: 160824, 380: 160825, 381: 160826, 382: 160827, 383: 160828, 384: 160829, 385: 160830, 386: 160831, 387: 160832, 388: 160833, 389: 160834, 390: 160835, 391: 160836, 392: 160837, 393: 160838, 394: 160839, 395: 160840, 396: 160841, 397: 160842, 398: 160843, 399: 160844, 400: 160845, 401: 160846, 402: 160847, 403: 160848, 404: 160849, 405: 160850, 406: 160851, 407: 160852, 408: 160853, 409: 160854, 410: 160855, 411: 160856, 412: 160857, 413: 160858, 414: 160859, 415: 160860, 416: 160861, 417: 160862, 418: 161071, 419: 161072, 420: 161073, 421: 161074, 422: 161075, 423: 161076, 424: 161077, 425: 161078, 426: 161079, 427: 161080, 428: 161081, 429: 161082, 430: 161083, 431: 161084, 432: 161085, 433: 161086, 434: 161087, 435: 161088, 436: 161089, 437: 161090, 438: 161091, 439: 161092, 440: 161093, 441: 161094, 442: 161095, 443: 161096, 444: 161097, 445: 161098, 446: 161099, 447: 161100, 448: 161101, 449: 161102, 450: 161103, 451: 161104, 452: 161105, 453: 161106, 454: 161107, 455: 161108, 456: 161109, 457: 161110, 458: 161111, 459: 161112, 460: 161113, 461: 161114, 462: 161115, 463: 161116, 464: 161117, 465: 161118, 466: 161119, 467: 161120, 468: 161121, 469: 161122, 470: 161123, 471: 161124, 472: 161125, 473: 161126, 474: 161127, 475: 161128, 476: 161129, 477: 161130, 478: 161131, 479: 161132, 480: 161133, 481: 161134, 482: 161135, 483: 161136, 484: 161137, 485: 161138, 486: 161139, 487: 161140, 488: 161141, 489: 161142, 490: 161143, 491: 161144, 492: 161145, 493: 161146, 494: 161147, 495: 161148, 496: 161149, 497: 161150, 498: 161151, 499: 161152, 500: 161153, 501: 161154, 502: 161155, 503: 161156, 504: 161157, 505: 161158, 506: 161159, 507: 161160, 508: 161161, 509: 161162, 510: 161163, 511: 161164, 512: 161165, 513: 161166, 514: 161167, 515: 161168, 516: 161169, 517: 161170, 518: 161171, 519: 161172, 520: 161173, 521: 161174, 522: 161175, 523: 161176, 524: 161177, 525: 161178, 526: 161179, 527: 161180, 528: 161181, 529: 161182, 530: 161183, 531: 161184, 532: 161185, 533: 161186, 534: 161187, 535: 161188, 536: 161189, 537: 161190, 538: 161191, 539: 161192, 540: 161193, 541: 161194, 542: 161195, 543: 161196, 544: 161197, 545: 161198, 546: 161199, 547: 161200, 548: 161201, 549: 161202, 550: 161203, 551: 161204, 552: 161205, 553: 161206, 554: 161207, 555: 161208, 556: 161209, 557: 161210, 558: 161211, 559: 161212, 560: 161213, 561: 161214, 562: 161215, 563: 161216, 564: 161217, 565: 161218, 566: 161219, 567: 161220, 568: 161221, 569: 161222, 570: 161223, 571: 161224, 572: 161225, 573: 161226, 574: 161227, 575: 161228, 576: 161229, 577: 161230, 579: 161231, 580: 161232, 581: 161233, 582: 161234, 583: 161235, 584: 161236, 585: 161237, 586: 161238, 587: 161239, 588: 161240, 589: 161241, 590: 161242, 591: 161243, 592: 161244, 593: 161245, 594: 161246, 595: 161247, 596: 161248, 597: 161249, 598: 161250, 599: 161251, 600: 161252, 601: 161253, 602: 161254, 603: 161255, 604: 161256, 605: 161257, 606: 161258, 607: 161259, 608: 161260, 609: 161261, 610: 161262, 611: 161263, 612: 161264, 613: 161265, 614: 161266, 615: 161267, 616: 161268, 617: 161269, 618: 161270, 619: 161271, 620: 161272, 621: 161273, 622: 161274, 623: 161275, 624: 161276, 625: 161277, 626: 161278, 628: 161279, 629: 161280, 630: 161281, 631: 161282, 632: 161283, 633: 161284, 634: 161285, 635: 161286, 636: 161287, 637: 161288, 638: 161289, 639: 161290, 640: 161291, 641: 161292, 642: 161293, 643: 161294, 644: 161295, 645: 161296, 646: 161297, 647: 161298, 648: 161299, 649: 161300, 650: 161301, 651: 161302, 652: 161303, 653: 161304, 654: 161305, 655: 161306, 656: 161307, 657: 161308, 658: 161309, 659: 161310, 660: 161311, 661: 161312, 662: 161313, 663: 161314, 664: 161315, 665: 161316, 666: 161317, 667: 161318, 668: 161319, 669: 161320, 670: 161321, 671: 161322, 672: 161323, 673: 161324, 674: 161325, 675: 161326, 676: 161327, 677: 161328, 678: 161329, 679: 161330, 680: 161331, 681: 161332, 682: 161333, 683: 161334, 684: 161335, 685: 161336, 686: 161337, 687: 161338, 688: 161339, 689: 161340, 690: 161341, 691: 161342, 692: 161343, 693: 161344, 694: 161345, 695: 161346, 696: 161347, 697: 161348, 698: 161349, 699: 161350, 700: 161351, 701: 161352, 702: 161353, 703: 161354, 704: 161355, 705: 161356, 706: 161357, 707: 161358, 708: 161359, 709: 161360, 710: 161361, 711: 161362, 712: 161363, 713: 161364, 714: 161365, 715: 161366, 716: 161367, 717: 161368, 718: 161369, 719: 161370, 720: 161371, 721: 161372, 722: 161373, 723: 161374, 724: 161375, 725: 161376, 726: 161377, 727: 161378, 728: 161379, 729: 161380, 730: 161381, 731: 161382, 732: 161383, 733: 161384, 734: 161385, 735: 161386, 736: 161387, 737: 161388, 738: 161389, 739: 161390, 740: 161391, 741: 161392, 742: 161393, 743: 161394, 744: 161395, 745: 161396, 746: 161397, 747: 161398, 748: 161399, 749: 161400, 750: 161401, 751: 161402, 752: 161403, 753: 161404, 754: 161405, 755: 161406, 756: 161407, 757: 161408, 758: 161409, 759: 161410, 760: 161411, 761: 161412, 762: 161413, 763: 161414, 764: 161415, 765: 161416, 766: 161417, 767: 161418, 768: 161419, 769: 161420, 770: 161421, 771: 161422, 772: 161423, 773: 161424, 774: 161425, 775: 161426, 776: 161427, 777: 161428, 778: 161429, 779: 161430, 780: 161431, 781: 161432, 782: 161433, 783: 161434, 784: 161435, 785: 161436, 786: 161437, 787: 161438, 788: 161439, 789: 161440, 790: 161441, 791: 161442, 792: 161443, 793: 161444, 794: 161445, 795: 161446, 796: 161447, 797: 161448, 798: 161449, 799: 161450, 800: 161451, 801: 161452, 802: 161453, 803: 161454, 804: 161455, 805: 161456, 806: 161457, 807: 161458, 808: 161459, 809: 161460, 810: 161461, 811: 161462, 812: 161463, 813: 161464, 814: 161465, 815: 161466, 816: 161467, 817: 161468, 818: 161469, 819: 161470, 820: 161471, 821: 161472, 822: 161473, 823: 161474, 824: 161475, 825: 161476, 826: 161477, 827: 161478, 828: 161479, 829: 161480, 830: 161481, 831: 161482, 832: 161483, 833: 161484, 834: 161485, 835: 161486, 836: 161487, 837: 161488, 838: 161489, 839: 161490, 840: 161491, 841: 161492, 842: 161493, 843: 161494, 844: 161495, 845: 161496, 846: 161497, 847: 161498, 848: 161499, 849: 161500, 850: 161501, 851: 161502, 852: 161503, 853: 161504, 854: 161505, 855: 161506, 856: 161507, 857: 161508, 858: 161509, 859: 161510, 860: 161511, 861: 161512, 862: 161513, 863: 161514, 864: 161515, 865: 161516, 866: 161517, 867: 161518, 868: 161519, 869: 161520, 870: 161521, 871: 161522, 872: 161523, 873: 161524, 874: 161525, 875: 161526, 876: 161527, 877: 161528, 878: 161529, 879: 161530, 880: 161531, 881: 161532, 882: 161533, 883: 161534, 884: 161535, 885: 161536, 886: 161537, 887: 161538, 888: 161539, 889: 161540, 890: 161541, 891: 161542, 892: 161543, 893: 161544, 894: 161545, 895: 161546, 896: 161547, 897: 161548, 898: 161549, 899: 161550, 900: 161551, 901: 161552, 902: 161553, 903: 161554, 904: 161555, 905: 161556, 906: 161557, 907: 161558, 908: 161559, 909: 161560, 910: 161561, 911: 161562, 912: 161563, 913: 161564, 914: 161565, 915: 161566, 916: 161567, 917: 161568, 918: 161569, 919: 161570, 920: 161571, 921: 161572, 922: 161573, 923: 161574, 924: 161575, 925: 161576, 926: 161577, 927: 161578, 928: 161579, 929: 161580, 930: 161581, 931: 161582, 932: 161583, 933: 161584, 934: 161585, 935: 161587, 936: 161588, 937: 161589, 938: 161590, 939: 161591, 940: 161592, 941: 161593, 942: 161594, 943: 161595, 944: 161596, 945: 161597, 946: 161598, 947: 161599, 948: 161600, 949: 161601, 950: 161602, 951: 161603, 952: 161604, 953: 161605, 954: 161606, 955: 161607, 956: 161608, 957: 161609, 958: 161610, 959: 161611, 960: 161612, 961: 161613, 962: 161614, 963: 161615, 964: 161616, 965: 161617, 966: 161618, 967: 161619, 968: 161620, 969: 161621, 970: 161622, 971: 161623, 972: 161624, 973: 161625, 974: 161626, 975: 161627, 976: 161628, 977: 161629, 978: 161630, 979: 161631, 980: 161632, 981: 161633, 982: 161634, 983: 161635, 984: 161636, 985: 161637, 986: 161638, 988: 161639, 989: 161640, 990: 161641, 991: 161642, 992: 161643, 993: 161644, 994: 161645, 995: 161646, 996: 161647, 997: 161648, 998: 161649, 999: 161650, 1000: 161651, 1001: 161652, 1002: 161653, 1003: 161654, 1004: 161655, 1005: 161656, 1006: 161657, 1007: 161658, 1008: 161659, 1009: 161660, 1010: 161661, 1011: 161662, 1012: 161663, 1013: 161664, 1014: 161665, 1015: 161666, 1016: 161667, 1017: 161668, 1018: 161669, 1019: 161670, 1020: 161671, 1021: 161672, 1022: 161673, 1023: 161674, 1024: 161675, 1025: 161676, 1026: 161677, 1027: 161678, 1028: 161679, 1029: 161680, 1030: 161681, 1031: 161682, 1032: 161683, 1033: 161684, 1034: 161685, 1035: 161686, 1036: 161687, 1037: 161688, 1038: 161689, 1039: 161690, 1040: 161691, 1041: 161692, 1042: 161693, 1043: 161694, 1044: 161695, 1045: 161696, 1046: 161697, 1047: 161698, 1048: 161699, 1049: 161700, 1050: 161701, 1051: 161702, 1052: 161703, 1053: 161704, 1054: 161705, 1055: 161706, 1056: 161707, 1057: 161708, 1058: 161709, 1059: 161710, 1060: 161711, 1061: 161712, 1062: 161713, 1063: 161714, 1064: 161715, 1065: 161716, 1066: 161717, 1067: 161718, 1068: 161719, 1069: 161720, 1070: 161721, 1071: 161722, 1072: 161723, 1073: 161724, 1074: 161725, 1075: 161726, 1076: 161727, 1077: 161728, 1078: 161729, 1079: 161730, 1080: 161731, 1081: 161732, 1082: 161733, 1083: 161734, 1084: 161735, 1085: 161736, 1086: 161737, 1087: 161738, 1088: 161739, 1089: 161740, 1090: 161741, 1091: 161742, 1092: 161743, 1093: 161744, 1094: 161745, 1095: 161746, 1096: 161747, 1097: 161748, 1098: 161749, 1099: 161750, 1100: 161751, 1101: 161752, 1102: 161753, 1103: 161754, 1104: 161755, 1105: 161756, 1106: 161757, 1107: 161758, 1108: 161759, 1109: 161760, 1110: 161761, 1111: 161762, 1112: 161763, 1113: 161764, 1114: 161765, 1115: 161766, 1116: 161767, 1117: 161768, 1118: 161769, 1119: 161770, 1120: 161771, 1121: 161772, 1122: 161773, 1123: 161774, 1124: 161775, 1125: 161776, 1126: 161777, 1127: 161778, 1128: 161779, 1129: 161780, 1130: 161781, 1131: 161782, 1132: 161783, 1133: 161784, 1134: 161785, 1135: 161786, 1136: 161787, 1137: 161788, 1138: 161789, 1139: 161790, 1140: 161791, 1141: 161792, 1142: 161793, 1143: 161794, 1144: 161795, 1145: 161796, 1146: 161797, 1147: 161798, 1148: 161799, 1149: 161800, 1150: 161801, 1151: 161802, 1152: 161803, 1153: 161804, 1154: 161805, 1155: 161806, 1156: 161807, 1157: 161808, 1158: 161809, 1159: 161810, 1160: 161811, 1161: 161812, 1162: 161813, 1163: 161814, 1164: 161815, 1165: 161816, 1166: 161817, 1167: 161818, 1168: 161819, 1169: 161820, 1170: 161821, 1171: 161822, 1172: 161823, 1173: 161824, 1174: 161825, 1175: 161826, 1176: 161827, 1177: 161828, 1178: 161829, 1179: 161830, 1180: 161831, 1181: 161832, 1182: 161833, 1183: 161834, 1184: 161835, 1185: 161836, 1186: 161837, 1187: 161838, 1188: 161839, 1189: 161840, 1190: 161841, 1191: 161842, 1192: 161843, 1193: 161844, 1194: 161845, 1195: 161846, 1196: 161847, 1197: 161848, 1198: 161849, 1199: 161850, 1200: 161851, 1201: 161852, 1202: 161853, 1203: 161854, 1204: 161855, 1205: 161856, 1206: 161857, 1207: 161858, 1208: 161859, 1209: 161860, 1210: 161861, 1211: 161862, 1212: 161863, 1213: 161864, 1214: 161865, 1215: 161866, 1216: 161867, 1217: 161868, 1218: 161869, 1219: 161870, 1220: 161871, 1221: 161872, 1222: 161873, 1223: 161874, 1224: 161875, 1225: 161876, 1226: 161877, 1227: 161878, 1228: 161879, 1229: 161880, 1230: 161881, 1231: 161882, 1232: 161883, 1233: 161884, 1234: 161885, 1235: 161886, 1236: 161887, 1237: 161888, 1238: 161889, 1239: 161890, 1240: 161891, 1241: 161892, 1243: 161893, 1244: 161894, 1245: 161895, 1246: 161896, 1247: 161897, 1248: 161898, 1249: 161899, 1250: 161900, 1251: 161901, 1252: 161902, 1253: 161903, 1254: 161904, 1255: 161905, 1256: 161906, 1257: 161907, 1258: 161908, 1259: 161909, 1260: 161910, 1261: 161911, 1262: 161912, 1263: 161913, 1264: 161914, 1265: 161915, 1266: 161916, 1267: 161917, 1268: 161918, 1269: 161919, 1270: 161920, 1271: 161921, 1272: 161922, 1273: 161923, 1274: 161924, 1275: 161925, 1276: 161926, 1277: 161927, 1278: 161928, 1279: 161929, 1280: 161930, 1281: 161931, 1282: 161932, 1283: 161933, 1284: 161934, 1285: 161935, 1286: 161936, 1287: 161937, 1288: 161938, 1289: 161939, 1290: 161940, 1291: 161941, 1292: 161942, 1293: 161943, 1294: 161944, 1295: 161945, 1296: 161946, 1297: 161947, 1298: 161948, 1299: 161949, 1300: 161950, 1301: 161951, 1302: 161952, 1303: 161953, 1304: 161954, 1305: 161955, 1306: 161956, 1307: 161957, 1308: 161958, 1309: 161959, 1310: 161960, 1311: 161961, 1312: 161962, 1313: 161963, 1314: 161964, 1315: 161965, 1316: 161966, 1317: 161967, 1318: 161968, 1319: 161969, 1320: 161970, 1321: 161971, 1322: 161972, 1323: 161973, 1324: 161974, 1325: 161975, 1326: 161976, 1327: 161977, 1328: 161978, 1329: 161979, 1330: 161980, 1331: 161981, 1332: 161982, 1333: 161983, 1334: 161984, 1335: 161985, 1336: 161986, 1337: 161987, 1338: 161988, 1339: 161989, 1340: 161990, 1341: 161991, 1342: 161992, 1343: 161993, 1344: 161994, 1345: 161995, 1346: 161996, 1348: 161997, 1349: 161998, 1350: 161999, 1351: 162000, 1352: 162001, 1353: 162002, 1354: 162003, 1355: 162004, 1356: 162005, 1357: 162006, 1358: 162007, 1359: 162008, 1360: 162009, 1361: 162010, 1362: 162011, 1363: 162012, 1364: 162013, 1365: 162014, 1366: 162015, 1367: 162016, 1368: 162017, 1369: 162018, 1370: 162019, 1371: 162020, 1372: 162021, 1373: 162022, 1374: 162023, 1375: 162024, 1376: 162025, 1377: 162026, 1378: 162027, 1379: 162028, 1380: 162029, 1381: 162030, 1382: 162031, 1383: 162032, 1384: 162033, 1385: 162034, 1386: 162035, 1387: 162036, 1388: 162037, 1389: 162038, 1390: 162039, 1391: 162040, 1392: 162041, 1393: 162042, 1394: 162043, 1395: 162044, 1396: 162045, 1397: 162046, 1398: 162047, 1399: 162048, 1400: 162049, 1401: 162050, 1402: 162051, 1403: 162673, 1404: 162053, 1405: 162054, 1406: 162055, 1407: 162386, 1408: 162057, 1409: 162058, 1410: 162059, 1411: 162060, 1412: 162061, 1413: 162062, 1414: 162063, 1415: 162064, 1416: 162065, 1417: 162066, 1418: 162067, 1419: 162068, 1420: 162069, 1421: 162070, 1422: 162071, 1423: 162072, 1424: 162073, 1425: 162074, 1426: 162075, 1427: 162076, 1428: 162077, 1429: 162078, 1430: 162079, 1431: 162080, 1432: 162081, 1433: 162082, 1434: 162083, 1435: 162084, 1436: 162085, 1437: 162086, 1438: 162087, 1439: 162088, 1440: 162089, 1441: 162090, 1442: 162091, 1443: 162092, 1444: 162093, 1445: 162094, 1446: 162095, 1447: 162096, 1448: 162097, 1449: 162098, 1450: 162099, 1451: 162100, 1452: 162101, 1455: 162102, 1456: 162103, 1457: 162104, 1458: 162105, 1459: 162106, 1461: 162107, 1464: 162108, 1465: 162109, 1466: 162110, 1467: 162111, 1469: 162113, 1472: 162114, 1473: 162115, 1474: 162116
            }
# MAP_POST = {x: x for x in range(1478)}

def revers_get_map():
    map_get_id_ssn = {x: x for x in range(1478)}
    # map_get_id_ssn = {1: 1461, 2: 1464, 3: 1463, 4: 1470, 5: 1466, 6: 1478, 7: 2907, 8: 1472, 9: 1477, 10: 1479,
    #                   11: 1462, 12: 1468, 13: 1467, 14: 1474, 15: 1471, 16: 1492, 17: 1489, 18: 1485, 19: 1482,
    #                   20: 1486, 21: 1465, 22: 1473, 23: 1481, 24: 1480, 25: 1483, 26: 1504, 27: 1511, 28: 1496,
    #                   29: 1491, 30: 1494, 31: 1469, 32: 1476, 33: 1493, 34: 1488, 35: 1495, 36: 1512, 37: 1518,
    #                   38: 1501, 39: 1502, 40: 1498, 41: 1475, 42: 1484, 43: 1500, 44: 1497, 45: 1503, 46: 1521,
    #                   47: 1542, 48: 1505, 49: 1506, 50: 1510, 51: 1487, 52: 1490, 53: 1508, 54: 1509, 55: 1513,
    #                   56: 1532, 57: 1552, 58: 1515, 59: 1519, 60: 1520, 61: 1507, 62: 1499, 63: 1523, 64: 1514,
    #                   65: 1524, 67: 1564, 68: 1526, 70: 1527, 71: 1516, 72: 1517, 73: 1528, 74: 1522, 75: 1534,
    #                   76: 1545, 77: 1575, 78: 1531, 79: 1525, 80: 1537, 81: 1536, 82: 1529, 83: 1543, 84: 1533,
    #                   85: 1544, 86: 1553, 87: 1581, 88: 1539, 89: 1530, 90: 1550, 91: 1538, 92: 1535, 93: 1546,
    #                   94: 1541, 95: 1554, 96: 1561, 97: 1600, 98: 1548, 99: 1540, 100: 1558, 101: 1555, 102: 1573,
    #                   103: 1551, 104: 1547, 105: 1566, 106: 1574, 107: 1607, 108: 1559, 109: 1549, 110: 1563, 111: 1571,
    #                   112: 1603, 113: 1565, 114: 1557, 115: 1579, 116: 1585, 117: 1613, 118: 1569, 119: 1556, 120: 1577,
    #                   121: 1580, 122: 1621, 123: 1570, 124: 1560, 125: 1588, 126: 1592, 127: 1619, 128: 1576, 129: 1562,
    #                   130: 1583, 131: 1589, 132: 1629, 133: 1578, 134: 1567, 135: 1596, 136: 1602, 137: 1630, 138: 1584,
    #                   139: 1568, 140: 1591, 141: 1598, 142: 1640, 143: 1586, 144: 1572, 145: 1609, 146: 1617, 147: 1634,
    #                   148: 1594, 149: 1582, 150: 1604, 151: 1605, 152: 1650, 153: 1599, 154: 1587, 155: 1620, 156: 1628,
    #                   157: 1646, 158: 1597, 159: 1593, 160: 1611, 161: 1614, 162: 1660, 163: 1606, 164: 1590, 165: 1625,
    #                   166: 1636, 167: 1651, 168: 1601, 169: 1643, 170: 1612, 171: 1622, 172: 1676, 173: 1627, 174: 1595,
    #                   175: 1626, 176: 1647, 177: 1655, 178: 1610, 179: 1667, 180: 1618, 181: 1631, 182: 1680, 183: 1641,
    #                   184: 1608, 185: 1633, 186: 1658, 187: 1664, 188: 1616, 189: 1682, 190: 1623, 191: 1632, 192: 1690,
    #                   193: 1649, 194: 1615, 195: 1645, 196: 1668, 197: 1671, 198: 1624, 199: 1685, 200: 1635, 201: 1637,
    #                   202: 1705, 203: 1656, 204: 1638, 206: 1683, 207: 1677, 208: 1648, 209: 1695, 210: 1644, 211: 1639,
    #                   212: 1718, 213: 1666, 214: 1642, 215: 1654, 216: 1693, 217: 1688, 218: 1659, 219: 1711, 220: 1653,
    #                   221: 1652, 222: 1733, 223: 1669, 224: 2908, 225: 1662, 226: 1703, 227: 1702, 228: 1672, 229: 1717,
    #                   230: 1674, 231: 1657, 232: 2909, 233: 1679, 234: 1661, 235: 1675, 236: 1714, 237: 1710, 238: 1681,
    #                   239: 1728, 240: 1687, 241: 1663, 242: 1748, 243: 1694, 244: 1670, 245: 1678, 246: 1721, 247: 1716,
    #                   248: 1691, 249: 1734, 250: 1692, 251: 1665, 252: 1756, 253: 1701, 254: 1686, 255: 1689, 256: 1726,
    #                   257: 1725, 258: 1699, 259: 1737, 260: 1698, 261: 1673, 262: 1759, 263: 1712, 264: 1696, 265: 1700,
    #                   266: 1738, 267: 1735, 268: 1706, 269: 1744, 270: 1729, 271: 1684, 272: 1763, 273: 1732, 274: 1704,
    #                   275: 1708, 276: 1745, 277: 1739, 278: 1709, 279: 1753, 280: 1746, 281: 1697, 282: 1772, 283: 1741,
    #                   284: 1715, 285: 1719, 286: 1747, 287: 1751, 288: 1723, 289: 1768, 290: 1764, 291: 1707, 292: 1779,
    #                   293: 1755, 294: 1722, 295: 1724, 296: 1795, 297: 1754, 298: 1781, 299: 1771, 300: 1773, 301: 1713,
    #                   302: 1789, 303: 1765, 304: 1736, 305: 1731, 306: 1804, 307: 1762, 308: 1790, 309: 1778, 310: 1780,
    #                   311: 1720, 312: 1797, 313: 1818, 314: 1740, 315: 1743, 316: 1855, 317: 1770, 318: 1800, 319: 1785,
    #                   320: 1786, 321: 1727, 322: 1813, 323: 1832, 324: 1749, 325: 1752, 326: 1861, 327: 1777, 328: 1807,
    #                   329: 1788, 330: 1793, 331: 1730, 332: 1819, 333: 1837, 334: 1757, 335: 1758, 336: 1877, 337: 1784,
    #                   338: 1823, 339: 1794, 340: 1803, 341: 1742, 342: 1826, 343: 1847, 344: 1760, 345: 1766, 346: 1892,
    #                   347: 1796, 348: 1835, 349: 1802, 350: 1810, 351: 1750, 352: 1830, 353: 1854, 354: 1767, 355: 1776,
    #                   356: 1897, 357: 1808, 358: 1844, 359: 1811, 360: 1821, 361: 1761, 362: 1840, 363: 1979, 364: 1774,
    #                   365: 1799, 366: 1958, 367: 1814, 368: 1857, 369: 1822, 370: 1841, 371: 1769, 372: 1849, 373: 1989,
    #                   374: 1782, 375: 1809, 376: 1970, 377: 1816, 378: 1863, 379: 1829, 380: 1850, 381: 1775, 382: 1862,
    #                   383: 2005, 384: 1792, 385: 1817, 386: 1976, 387: 1824, 388: 1872, 389: 1842, 390: 1856, 391: 1783,
    #                   392: 1869, 393: 2012, 394: 1801, 395: 1827, 396: 1988, 397: 1828, 398: 1873, 399: 1848, 400: 1864,
    #                   401: 1787, 402: 1888, 403: 2020, 404: 1806, 405: 1836, 406: 2007, 407: 1838, 408: 1885, 409: 1858,
    #                   410: 1874, 411: 1791, 412: 1896, 413: 2033, 414: 1812, 415: 1843, 416: 2014, 417: 1845, 418: 1887,
    #                   419: 1876, 420: 1881, 421: 1798, 422: 1904, 423: 2038, 424: 1825, 425: 1852, 426: 2027, 427: 1868,
    #                   428: 1894, 429: 1883, 430: 1889, 431: 1805, 432: 1913, 433: 2050, 434: 1833, 435: 1866, 436: 2036,
    #                   437: 1879, 438: 1905, 439: 1893, 440: 1901, 441: 1815, 442: 1921, 443: 2057, 444: 1846, 445: 1884,
    #                   446: 2079, 447: 1891, 448: 1912, 449: 1902, 450: 1910, 451: 1820, 452: 1933, 453: 2070, 454: 1851,
    #                   455: 1886, 456: 2085, 457: 1899, 458: 1925, 459: 1907, 460: 1918, 461: 1831, 462: 1941, 463: 2163,
    #                   464: 1859, 465: 1895, 466: 2088, 467: 1909, 468: 1932, 469: 1916, 470: 1924, 471: 1834, 472: 1955,
    #                   473: 2176, 474: 1865, 475: 1898, 476: 2092, 477: 1926, 478: 1939, 479: 1935, 480: 1929, 481: 1839,
    #                   482: 1963, 483: 2186, 484: 1871, 485: 1903, 486: 2100, 487: 1930, 488: 1946, 489: 1944, 490: 1937,
    #                   491: 1853, 492: 1972, 493: 2195, 494: 1878, 495: 1911, 496: 2104, 497: 1945, 498: 1956, 499: 1949,
    #                   500: 1942, 501: 1860, 502: 1980, 503: 2196, 504: 1882, 505: 1915, 506: 2111, 507: 1950, 508: 1969,
    #                   509: 1954, 510: 1948, 511: 1867, 512: 1984, 513: 2200, 514: 1890, 515: 1919, 516: 2119, 517: 1964,
    #                   518: 1977, 519: 1960, 520: 1952, 521: 1870, 522: 1990, 523: 2212, 524: 2910, 525: 1923, 526: 2131,
    #                   527: 2001, 528: 1991, 529: 1968, 530: 1962, 531: 1875, 532: 1992, 533: 2218, 534: 1908, 535: 1927,
    #                   536: 2138, 537: 2009, 538: 1995, 539: 1978, 540: 1971, 541: 1880, 542: 1996, 543: 2224, 544: 1914,
    #                   545: 1928, 546: 2141, 547: 2017, 548: 1999, 549: 1986, 550: 1974, 551: 2911, 552: 2004, 553: 2241,
    #                   554: 1920, 555: 1938, 556: 2152, 557: 2032, 558: 2030, 559: 2000, 560: 1981, 561: 1900, 562: 2024,
    #                   563: 2248, 564: 1931, 565: 1953, 566: 2912, 567: 2034, 568: 2039, 569: 2010, 570: 2002, 571: 1906,
    #                   572: 2035, 573: 2261, 574: 1940, 575: 1961, 576: 2181, 577: 2045, 579: 2023, 580: 2019, 581: 1917,
    #                   582: 2041, 583: 2267, 584: 1947, 585: 1967, 586: 2185, 587: 2046, 588: 2054, 589: 2026, 590: 2029,
    #                   591: 1922, 592: 2048, 593: 2275, 594: 1957, 595: 1975, 596: 2197, 597: 2059, 598: 2060, 599: 2040,
    #                   600: 2037, 601: 1934, 602: 2056, 603: 2286, 604: 1959, 605: 1983, 606: 2203, 607: 2066, 608: 2069,
    #                   609: 2047, 610: 2051, 611: 1936, 612: 2063, 613: 2301, 614: 1965, 615: 1987, 616: 2217, 617: 2084,
    #                   618: 2072, 619: 2058, 620: 2062, 621: 1943, 622: 2071, 623: 2305, 624: 1982, 625: 1998, 626: 2232,
    #                   628: 2077, 629: 2075, 630: 2074, 631: 1951, 632: 2083, 633: 2913, 634: 1985, 635: 2008, 636: 2242,
    #                   637: 2096, 638: 2087, 639: 2093, 640: 2081, 641: 1966, 642: 2094, 643: 2321, 644: 1994, 645: 2013,
    #                   646: 2247, 647: 2101, 648: 2095, 649: 2105, 650: 2086, 651: 1973, 652: 2107, 653: 2334, 654: 1997,
    #                   655: 2021, 656: 2251, 657: 2108, 658: 2103, 659: 2120, 660: 2097, 661: 1993, 662: 2122, 663: 2340,
    #                   664: 2003, 665: 2025, 666: 2256, 667: 2118, 668: 2117, 669: 2132, 670: 2106, 671: 2006, 672: 2130,
    #                   673: 2343, 674: 2015, 675: 2031, 676: 2268, 677: 2124, 678: 2125, 679: 2145, 680: 2113, 681: 2011,
    #                   682: 2136, 683: 2345, 684: 2018, 685: 2044, 686: 2272, 687: 2137, 688: 2135, 689: 2148, 690: 2116,
    #                   691: 2016, 692: 2146, 693: 2350, 694: 2028, 695: 2049, 696: 2276, 697: 2150, 698: 2144, 699: 2156,
    #                   700: 2127, 701: 2022, 702: 2154, 703: 2354, 704: 2042, 705: 2055, 706: 2282, 707: 2164, 708: 2151,
    #                   709: 2162, 710: 2129, 711: 2043, 712: 2158, 713: 2371, 714: 2053, 715: 2061, 716: 2290, 717: 2168,
    #                   718: 2161, 719: 2170, 720: 2143, 721: 2052, 722: 2175, 723: 2376, 724: 2068, 725: 2064, 726: 2298,
    #                   727: 2174, 728: 2167, 729: 2179, 730: 2155, 731: 2065, 732: 2177, 733: 2394, 734: 2073, 735: 2067,
    #                   736: 2306, 737: 2182, 738: 2183, 739: 2184, 740: 2160, 741: 2076, 742: 2188, 743: 2402, 744: 2082,
    #                   745: 2078, 746: 2315, 747: 2189, 748: 2202, 749: 2206, 750: 2166, 751: 2080, 752: 2201, 753: 2411,
    #                   754: 2090, 755: 2099, 756: 2316, 757: 2193, 758: 2216, 759: 2209, 760: 2171, 761: 2089, 762: 2211,
    #                   763: 2413, 764: 2091, 765: 2109, 766: 2326, 767: 2208, 768: 2221, 769: 2214, 770: 2180, 771: 2102,
    #                   772: 2222, 773: 2415, 774: 2098, 775: 2114, 776: 2339, 777: 2220, 778: 2223, 779: 2226, 780: 2192,
    #                   781: 2112, 782: 2231, 783: 2423, 784: 2110, 785: 2123, 786: 2344, 787: 2240, 788: 2238, 789: 2230,
    #                   790: 2205, 791: 2121, 792: 2236, 793: 2431, 794: 2115, 795: 2142, 796: 2347, 797: 2243, 798: 2254,
    #                   799: 2235, 800: 2210, 801: 2133, 802: 2239, 803: 2439, 804: 2126, 805: 2153, 806: 2356, 807: 2253,
    #                   808: 2259, 809: 2245, 810: 2215, 811: 2134, 812: 2257, 813: 2445, 814: 2128, 815: 2169, 816: 2361,
    #                   817: 2265, 818: 2277, 819: 2250, 820: 2228, 821: 2139, 822: 2266, 823: 2452, 824: 2140, 825: 2178,
    #                   826: 2367, 827: 2273, 828: 2291, 829: 2255, 830: 2234, 831: 2147, 832: 2283, 833: 2461, 834: 2149,
    #                   835: 2191, 836: 2369, 837: 2288, 838: 2299, 839: 2264, 840: 2246, 841: 2159, 842: 2287, 843: 2466,
    #                   844: 2157, 845: 2914, 846: 2375, 847: 2297, 848: 2311, 849: 2270, 850: 2260, 851: 2172, 852: 2296,
    #                   853: 2475, 854: 2165, 855: 2198, 856: 2390, 857: 2303, 858: 2364, 859: 2279, 860: 2274, 861: 2190,
    #                   862: 2314, 863: 2483, 864: 2173, 865: 2219, 866: 2397, 867: 2308, 868: 2373, 869: 2915, 870: 2284,
    #                   871: 2199, 872: 2323, 873: 2491, 874: 2187, 875: 2229, 876: 2410, 877: 2322, 878: 2386, 879: 2304,
    #                   880: 2294, 881: 2207, 882: 2336, 883: 2496, 884: 2194, 885: 2233, 886: 2418, 887: 2327, 888: 2393,
    #                   889: 2307, 890: 2309, 891: 2213, 892: 2346, 893: 2502, 894: 2204, 895: 2249, 896: 2424, 897: 2333,
    #                   898: 2401, 899: 2317, 900: 2318, 901: 2225, 902: 2359, 903: 2513, 904: 2227, 905: 2258, 906: 2428,
    #                   907: 2355, 908: 2405, 909: 2330, 910: 2331, 911: 2244, 912: 2382, 913: 2521, 914: 2237, 915: 2278,
    #                   916: 2436, 917: 2363, 918: 2406, 919: 2342, 920: 2338, 921: 2263, 922: 2398, 923: 2537, 924: 2252,
    #                   925: 2289, 926: 2440, 927: 2377, 928: 2422, 929: 2352, 930: 2916, 931: 2269, 932: 2404, 933: 2547,
    #                   934: 2262, 935: 2295, 936: 2450, 937: 2384, 938: 2437, 939: 2358, 940: 2351, 941: 2280, 942: 2409,
    #                   943: 2555, 944: 2271, 945: 2310, 946: 2457, 947: 2388, 948: 2451, 949: 2370, 950: 2365, 951: 2292,
    #                   952: 2419, 953: 2563, 954: 2281, 955: 2320, 956: 2463, 957: 2391, 958: 2458, 959: 2385, 960: 2372,
    #                   961: 2293, 962: 2435, 963: 2570, 964: 2285, 965: 2325, 966: 2468, 967: 2395, 968: 2459, 969: 2392,
    #                   970: 2380, 971: 2300, 972: 2446, 973: 2585, 974: 2302, 975: 2335, 976: 2479, 977: 2407, 978: 2465,
    #                   979: 2408, 980: 2389, 981: 2312, 982: 2454, 983: 2594, 984: 2313, 985: 2348, 986: 2480, 988: 2473,
    #                   989: 2416, 990: 2403, 991: 2319, 992: 2471, 993: 2600, 994: 2324, 995: 2353, 996: 2489, 997: 2421,
    #                   998: 2481, 999: 2426, 1000: 2412, 1001: 2329, 1002: 2482, 1003: 2602, 1004: 2328, 1005: 2360,
    #                   1006: 2494, 1007: 2425, 1008: 2487, 1009: 2433, 1010: 2420, 1011: 2332, 1012: 2503, 1013: 2611,
    #                   1014: 2337, 1015: 2368, 1016: 2506, 1017: 2430, 1018: 2504, 1019: 2441, 1020: 2434, 1021: 2341,
    #                   1022: 2523, 1023: 2618, 1024: 2357, 1025: 2374, 1026: 2530, 1027: 2442, 1028: 2510, 1029: 2456,
    #                   1030: 2438, 1031: 2349, 1032: 2534, 1033: 2633, 1034: 2917, 1035: 2379, 1036: 2546, 1037: 2447,
    #                   1038: 2519, 1039: 2464, 1040: 2443, 1041: 2362, 1042: 2543, 1043: 2640, 1044: 2378, 1045: 2387,
    #                   1046: 2553, 1047: 2453, 1048: 2528, 1049: 2474, 1050: 2448, 1051: 2366, 1052: 2551, 1053: 2645,
    #                   1054: 2383, 1055: 2396, 1056: 2561, 1057: 2469, 1058: 2536, 1059: 2486, 1060: 2449, 1061: 2381,
    #                   1062: 2556, 1063: 2653, 1064: 2399, 1065: 2427, 1066: 2580, 1067: 2477, 1068: 2544, 1069: 2501,
    #                   1070: 2467, 1071: 2400, 1072: 2583, 1073: 2662, 1074: 2417, 1075: 2429, 1076: 2592, 1077: 2490,
    #                   1078: 2562, 1079: 2512, 1080: 2484, 1081: 2414, 1082: 2622, 1083: 2670, 1084: 2432, 1085: 2460,
    #                   1086: 2613, 1087: 2497, 1088: 2574, 1089: 2516, 1090: 2495, 1091: 2472, 1092: 2629, 1093: 2680,
    #                   1094: 2444, 1095: 2470, 1096: 2616, 1097: 2505, 1098: 2577, 1099: 2525, 1100: 2509, 1101: 2493,
    #                   1102: 2639, 1103: 2694, 1104: 2455, 1105: 2485, 1106: 2621, 1107: 2517, 1108: 2589, 1109: 2532,
    #                   1110: 2520, 1111: 2499, 1112: 2657, 1113: 2697, 1114: 2462, 1115: 2492, 1116: 2627, 1117: 2526,
    #                   1118: 2591, 1119: 2539, 1120: 2524, 1121: 2508, 1122: 2665, 1123: 2705, 1124: 2476, 1125: 2511,
    #                   1126: 2632, 1127: 2606, 1128: 2599, 1129: 2550, 1130: 2533, 1131: 2518, 1132: 2674, 1133: 2712,
    #                   1134: 2478, 1135: 2515, 1136: 2638, 1137: 2612, 1138: 2605, 1139: 2559, 1140: 2541, 1141: 2527,
    #                   1142: 2682, 1143: 2716, 1144: 2488, 1145: 2522, 1146: 2643, 1147: 2619, 1148: 2610, 1149: 2564,
    #                   1150: 2548, 1151: 2538, 1152: 2689, 1153: 2720, 1154: 2498, 1155: 2531, 1156: 2647, 1157: 2628,
    #                   1158: 2615, 1159: 2569, 1160: 2560, 1161: 2540, 1162: 2695, 1163: 2737, 1164: 2500, 1165: 2545,
    #                   1166: 2658, 1167: 2644, 1168: 2617, 1169: 2578, 1170: 2568, 1171: 2549, 1172: 2701, 1173: 2745,
    #                   1174: 2507, 1175: 2552, 1176: 2666, 1177: 2650, 1178: 2626, 1179: 2581, 1180: 2573, 1181: 2557,
    #                   1182: 2708, 1183: 2756, 1184: 2514, 1185: 2558, 1186: 2676, 1187: 2655, 1188: 2634, 1189: 2590,
    #                   1190: 2579, 1191: 2567, 1192: 2711, 1193: 2760, 1194: 2529, 1195: 2565, 1196: 2679, 1197: 2667,
    #                   1198: 2642, 1199: 2597, 1200: 2588, 1201: 2571, 1202: 2718, 1203: 2764, 1204: 2535, 1205: 2572,
    #                   1206: 2693, 1207: 2673, 1208: 2646, 1209: 2601, 1210: 2596, 1211: 2576, 1212: 2725, 1213: 2769,
    #                   1214: 2542, 1215: 2584, 1216: 2703, 1217: 2681, 1218: 2652, 1219: 2607, 1220: 2603, 1221: 2582,
    #                   1222: 2733, 1223: 2772, 1224: 2554, 1225: 2593, 1226: 2715, 1227: 2692, 1228: 2656, 1229: 2620,
    #                   1230: 2609, 1231: 2598, 1232: 2740, 1233: 2781, 1234: 2566, 1235: 2608, 1236: 2728, 1237: 2706,
    #                   1238: 2664, 1239: 2637, 1240: 2624, 1241: 2614, 1243: 2798, 1244: 2575, 1245: 2625, 1246: 2757,
    #                   1247: 2724, 1248: 2685, 1249: 2663, 1250: 2651, 1251: 2631, 1252: 2751, 1253: 2806, 1254: 2586,
    #                   1255: 2649, 1256: 2768, 1257: 2753, 1258: 2704, 1259: 2677, 1260: 2654, 1261: 2635, 1262: 2758,
    #                   1263: 2810, 1264: 2587, 1265: 2659, 1266: 2773, 1267: 2766, 1268: 2721, 1269: 2698, 1270: 2660,
    #                   1271: 2641, 1272: 2761, 1273: 2818, 1274: 2595, 1275: 2671, 1276: 2782, 1277: 2774, 1278: 2730,
    #                   1279: 2717, 1280: 2669, 1281: 2668, 1282: 2767, 1283: 2821, 1284: 2604, 1285: 2683, 1286: 2793,
    #                   1287: 2777, 1288: 2734, 1289: 2727, 1290: 2687, 1291: 2675, 1292: 2776, 1293: 2825, 1294: 2623,
    #                   1295: 2686, 1296: 2800, 1297: 2796, 1298: 2748, 1299: 2738, 1300: 2690, 1301: 2684, 1302: 2791,
    #                   1303: 2836, 1304: 2630, 1305: 2920, 1306: 2807, 1307: 2815, 1308: 2754, 1309: 2743, 1310: 2699,
    #                   1311: 2691, 1312: 2844, 1313: 2837, 1314: 2636, 1315: 2713, 1316: 2816, 1317: 2822, 1318: 2775,
    #                   1319: 2759, 1320: 2702, 1321: 2700, 1322: 2851, 1323: 2843, 1324: 2648, 1325: 2726, 1326: 2823,
    #                   1327: 2827, 1328: 2780, 1329: 2771, 1330: 2710, 1331: 2707, 1332: 2856, 1333: 2845, 1334: 2661,
    #                   1335: 2735, 1336: 2830, 1337: 2833, 1338: 2787, 1339: 2778, 1340: 2722, 1341: 2714, 1342: 2860,
    #                   1343: 2847, 1344: 2672, 1345: 2744, 1346: 2835, 1348: 2792, 1349: 2784, 1350: 2729, 1351: 2731,
    #                   1352: 2867, 1353: 2857, 1354: 2678, 1355: 2750, 1356: 2842, 1357: 2840, 1358: 2803, 1359: 2788,
    #                   1360: 2741, 1361: 2739, 1362: 2878, 1363: 2866, 1364: 2688, 1365: 2765, 1366: 2854, 1367: 2853,
    #                   1368: 2812, 1369: 2797, 1370: 2755, 1371: 2749, 1372: 2885, 1373: 2870, 1374: 2696, 1375: 2779,
    #                   1376: 2863, 1377: 2864, 1378: 2829, 1379: 2804, 1380: 2762, 1381: 2763, 1382: 2890, 1383: 2874,
    #                   1384: 2709, 1385: 2785, 1386: 2871, 1387: 2868, 1388: 2841, 1389: 2813, 1390: 2770, 1391: 2786,
    #                   1392: 2898, 1393: 2880, 1394: 2719, 1395: 2789, 1396: 2873, 1397: 2872, 1398: 2846, 1399: 2819,
    #                   1400: 2783, 1401: 2794, 1402: 2899, 1403: 2884, 1404: 2723, 1405: 2795, 1406: 2875, 1407: 2876,
    #                   1408: 2849, 1409: 2820, 1410: 2790, 1411: 2805, 1412: 2900, 1413: 2886, 1414: 2732, 1415: 2799,
    #                   1416: 2879, 1417: 2877, 1418: 2852, 1419: 2826, 1420: 2801, 1421: 2809, 1422: 2901, 1423: 2889,
    #                   1424: 2736, 1425: 2808, 1426: 2882, 1427: 2881, 1428: 2855, 1429: 2831, 1430: 2802, 1431: 2848,
    #                   1432: 2902, 1433: 2891, 1434: 2742, 1435: 2918, 1436: 2887, 1437: 2883, 1438: 2859, 1439: 2832,
    #                   1440: 2811, 1441: 2850, 1442: 2904, 1443: 2894, 1444: 2746, 1445: 2817, 1446: 2892, 1447: 2888,
    #                   1448: 2861, 1449: 2834, 1450: 2814, 1451: 2858, 1452: 2905, 1455: 2824, 1456: 2896, 1457: 2893,
    #                   1458: 2865, 1459: 2838, 1461: 2862, 1464: 2747, 1465: 2828, 1466: 2903, 1467: 2895, 1468: 2869,
    #                   1469: 2839, 1472: 2906, 1473: 2897, 1474: 2752, 1478: 2919
    #                   }  # this is a map id -> ssn in the server db we are copying from
    reversed_map = dict(zip(map_get_id_ssn.values(), map_get_id_ssn.keys()))
    return reversed_map

def get_ssn(read_id, reversed_get_map):
    """
    gets a sheet id from a server and maps it to the correct ssn (using tags)
    :param read_id: Sheet id
    :return: ssn
    """
    ssn = reversed_get_map.get(int(read_id), 0)
    if not ssn:
        ssn = int(read_id)
    return ssn

def get_post_id(ssn):
    """
    for the post server gets a ssn and returns the id to which the sheet should be connected. based on the ssn<->id mapping
    on the post server which we learn from the ssn tags
    :param ssn:
    :return:
    """
    map_post_ssn_id = MAP_POST


    # map_post_ssn_id = {y: x for x, y in map_post_id_ssn.iteritems()}
    post_id = map_post_ssn_id.get(ssn, 0)
    if not post_id: # got zero, hence couldn't find this ssn in the table
        post_id=ssn
    return post_id

def get_sheets_from_get_server(list_get_sheet_ids, get_server_address):
    got_sheets = []
    for id in list_get_sheet_ids:
        url = get_server_address + "/api/sheets/{}".format(id)
        got = http_request(url, body={"apikey": API_KEY}, method="GET")
        got_sheets.append(got)
    return got_sheets
    
def link_sheet(sheet_json, get_ssn_map,post_id=None):
    """

    :param sheet_json: the guts of a sheet
    :param post_id: an option to post the sheet over a different sheet that is on the server and not back over the original
    :return: returns the new (fixed links for the server) sheet_json
    """
    if not post_id:
        post_id=sheet_json['id']

    compile_refmeta = re.compile(u'<(?P<refmeta>a href=)"/sheets/(?P<id2>\d+?")>')
    compile = re.compile(u'/sheets/(?P<id>\d+)')  # (?:\.(?P<node>\d+))? # there is a proble, here. it returns/ or reads only the first see. ssn 911. id 552
    for i, s in enumerate(sheet_json['sources']):
        if 'outsideText' in s.keys():
            uni_outsidetext = unicode(s['outsideText'], encoding='utf8') if isinstance(s['outsideText'], str) else s[
                'outsideText']
            for match in re.finditer(compile, s['outsideText']):
                ssn = get_ssn(match.group("id"), get_ssn_map)  # this is the ssn of the sheet to connect to
                print ssn
                to_post_id = get_post_id(ssn)
                s['outsideText'] = re.sub(match.group("id"), str(to_post_id), s['outsideText'])
                print s['outsideText']
        elif 'outsideBiText' in s.keys():
            uni_outsidetext = unicode(s['outsideBiText']['he'], encoding='utf8') if isinstance(s['outsideBiText']['he'],
                                                                                               str) else \
                s['outsideBiText']['he']
            # hebrew links
            for match in re.finditer(compile, s['outsideBiText']['he']):
                ssn = get_ssn(match.group("id"),get_ssn_map)  # this is the ssn of the sheet to connect to
                print ssn
                to_post_id = get_post_id(ssn)
                s['outsideBiText']['he'] = re.sub(match.group("id"), str(to_post_id), s['outsideBiText']['he'])
                print s['outsideBiText']['he']
            # english links
            for match in re.finditer(compile, s['outsideBiText']['en']):
                ssn = get_ssn(match.group("id"), get_ssn_map)  # this is the ssn of the sheet to connect to
                print ssn
                to_post_id = get_post_id(ssn)
                s['outsideBiText']['en'] = re.sub(match.group("id"), str(to_post_id), s['outsideBiText']['en'])
                ref_meta_match = re.search(compile_refmeta, s['outsideBiText']['en'])
                if ref_meta_match:
                    s['outsideBiText']['en'] = re.sub(ref_meta_match.group('refmeta'), u'a class="refLink" target="_blank" href=', s['outsideBiText']['en'])
                # s['outsideBiText']['en'] = re.sub(u'class="refLink" target="_blank"', u'', s['outsideBiText']['en'])

                print s['outsideBiText']['en']
            # matched = re.search(compile, s['outsideBiText'])
            # if matched:
            #     ssn = get_ssn(matched.group("id"))
            #     to_post_id = get_post_id(ssn)
            #     new_link = re.sub(compile, u'/sheets/{}'.format(to_post_id), s['outsideText'])
            #     s['outsideBiText'] = re.sub(compile, u'/sheets/\g<id>', new_link)  # todo: check and then test this line
    del sheet_json['_id']
    sheet_json['id'] = post_id
    return sheet_json

if __name__ == "__main__":
    #use list of which sheets have links which has sheet title and sheet year and tags
    #for each sheet, get each segment and check if it has
    sheet_data = []
    # sheets = db.sheets.find({"tags": "Hebrew Sheet"})
    compile = re.compile(u'/sheets/(?P<id>\d+)')  # (?:\.(?P<node>\d+))?
    get_ssn_map = revers_get_map()
    ids = [162053]#[160441, 160684, 160631, 161425, 162058, 160600, 160760, 160454, 162331, 160698, 160636, 160576, 161312, 162336, 162051, 162089, 162325, 160475, 162327, 160755, 160482, 162328, 162334, 160484, 161271, 160485, 160486, 162332, 162333, 162337, 162335, 160488, 160546, 162673, 162053, 162054, 162055, 162386]
 # MAP_POST.values()
    sheets = get_sheets_from_get_server(ids, GET_SERVER)  # list_get_sheet_ids comes straight from mongo range(155157, 156614)
    progress = 0
    for sheet_json in sheets:
        print sheet_json['id']
        linked_json = link_sheet(sheet_json, get_ssn_map)  #, post_id=256)
        # if linked_json == sheet_json:
        #     continue
        linked_json = change_sheet(linked_json, del_tags=["UI", "int_tag"], pdf_action="change")
        post_sheet(linked_json, POST_SERVER)
        progress += 1
        print "progress: {}".format(progress)
    # for x in range(21, 1471, 10):
    #     sheets = get_sheets_from_get_server(range(x, x+10), GET_SERVER)  # list_get_sheet_ids comes straight from mongo
    #     for sheet_json in sheets:
    #         link_sheet(sheet_json)
    #         post_sheet(sheet_json, POST_SERVER)
    # # for title_year_tags in sheet_data:
    # #     title, year, tags = title_year_tags
    # #     sheet = db.sheets.find({"title": title, "summary": year, "tags": tags})
    # #     assert sheet, u"Couldn't find sheet {}".format(title)
    # #     for segment in sheet["sources"]:
    # #         text = segment["text"]["he"] if "text" in segment.keys() else segment["outsideText"]
    # #         for match in re.findall("^<a href.*?nechama.org.il/pages/.*?</a>", text):
    # #             text = text.replace(match, )



