# -*- coding: utf-8 -*-
"""
Post a sheet form the local enviornment to a remote enviornment, using an API Key.
"""
import django
django.setup()
import urllib2
import requests
import regex as re
from sefaria.system.database import db
from sefaria.sheets import get_sheet
from sources.functions import post_sheet, http_request
from sources.local_settings import *

# GET_SERVER = "http://nechama.sandbox.sefaria.org"
# GET_SERVER = "http://qanechama.sandbox.sefaria.org"
# GET_SERVER = "http://localhost:8000"
GET_SERVER = "http://einmishpat.sandbox.sefaria.org"


# POST_SERVER = "http://nechama.sandbox.sefaria.org"
# POST_SERVER = "http://qanechama.sandbox.sefaria.org"
# POST_SERVER = "http://localhost:8000"
POST_SERVER = "http://shmuel.sandbox.sefaria.org"

get_server = GET_SERVER
post_server = POST_SERVER

def linking(json_sheet, post_id=None):
    if not post_id:
        post_id=json_sheet['id']
    json_sheet_str = str(json_sheet).replace(u'\\\\', u'')
    url = get_server + "/api/sheets/{}".format(post_id)
    got = http_request(url, body={"apikey": API_KEY}, method="GET")
    compile = re.compile(u'(?P<aref><a.*?/sheets.*?>(?P<text>.*?)</a>)')
    for match in re.finditer(compile, str(got)):
        json_sheet_str = re.sub(match.group('text'), match.group('aref'), json_sheet_str)
    return eval(json_sheet_str)

def change_sheet(this_sheet, del_tags=[], add_tags=[]):
    # deal with tags
    to_delete = []  # the list of tags to delete - so not to change the list while still iterating through it
    for tag in this_sheet[u'tags']:
        if isinstance(tag, int) or tag.isdigit():
            tag = str(tag).strip()
            # todo: deal with the pdf link
            # this_sheet['summary'] = this_sheet['summary'] + u" http://www.nechama.org.il/pdf/{}.pdf".format(tag)
            this_sheet["ssn"] = int(tag)
            if "int_tag" in del_tags:
                to_delete.append(tag)
        if (tag in del_tags) or re.search(u'[א-ת]', tag):
            to_delete.append(tag) #this_sheet[u'tags'].remove(tag)
    for tag in to_delete:
        this_sheet[u'tags'].remove(tag)
    this_sheet[u'tags'].extend(add_tags)
    # deal with owner todo: make this work also throw the api post
    this_sheet["status"] = "unlisted"
    # this_sheet = linking(this_sheet)
    return this_sheet




def post_btween_sandboxes(ssn=None, map_ssn_url_post=None, map_ssn_url_get=None, id=None, id_post=None, new_post = False):
    if not ssn and not id:
        print "missing either a ssn or an sheet_id of the sheet to be posted"
        return
    if ssn:
        try:
            assert map_ssn_url_get and map_ssn_url_post
        except AssertionError:
            print "if using ssn you must give the corresponding maps"
        post_sheet_id = map_ssn_url_post[ssn]  # the latest sheet with that ssn number we want to repost over
        get_sheet_id = map_ssn_url_get[ssn]  # can also be from a ssn mapping from the correct server the fixed sheet that was created (sometimes from the old sheet itself), need to know it
    else:  # id - because if it is neither we returns already :)
        get_sheet_id = id
        if id_post:
            post_sheet_id = id_post
        else:
            post_sheet_id = id

    url = get_server + "/api/sheets/{}".format(get_sheet_id)
    got = http_request(url, body={"apikey": API_KEY}, method="GET")

    # got = linking(got, post_sheet_id)
    changed = change_sheet(got, add_tags=[], del_tags=["UI"])
    del changed['_id']


    if new_post:
        del changed['id']
    else:
        changed['id'] = post_sheet_id
        # # delete sheet in post sheet number - note: when it is reposting the sheet will only be in this script RAM so always!!! have a backup
        delete_url = post_server + "/api/sheets/{}/delete".format(post_sheet_id)
        response = http_request(delete_url, body={"apikey": API_KEY})
        if re.search("Sheet {} not found.".format(post_sheet_id), response):
            del changed['id']

    #post the copyed sheet in there
    response = post_sheet(changed, server=POST_SERVER)
    if isinstance(response, unicode) and re.search('error', response):
        print response
## post them over themself (for the sheet to sheet linking process)

# sheets = [map_ssn_url[x] for x in ssn_sheets]
# for ssn in sheets_ssn:
#     got = get_sheet(sheet[u'id'])
#     url = SEFARIA_SERVER + "/api/sheets/{}".format(sheet_id)
#     got = http_request(url, body={"apikey": API_KEY}, method="GET")
#     changed = change_sheet(got, add_tags=[])
#     changed['id'] = post_ssn_map[ssn]
#     del changed['_id']
#     post_sheet(changed, server=SEFARIA_SERVER)
# pass
if __name__ == "__main__":
    # create this mapping on the GET_SERVER via map_ssn_url.py on the correct db
    map_get = {1: 1, 2: 7, 3: 8, 4: 12, 5: 2, 6: 11, 7: 15, 8: 16, 9: 3, 10: 14, 11: 21, 12: 19, 13: 4, 14: 17, 15: 23, 16: 24, 17: 5, 18: 22, 19: 26, 20: 27, 21: 6, 22: 25, 23: 30, 24: 28, 25: 9, 26: 87, 27: 34, 28: 29, 29: 10, 30: 92, 31: 36, 32: 31, 33: 13, 34: 95, 35: 39, 36: 32, 37: 18, 38: 96, 39: 40, 40: 33, 41: 20, 42: 99, 43: 42, 44: 35, 45: 86, 46: 101, 47: 46, 48: 37, 49: 89, 50: 104, 51: 1079, 52: 38, 53: 90, 54: 107, 55: 1080, 56: 41, 57: 91, 58: 109, 59: 1082, 60: 43, 61: 93, 62: 112, 63: 1083, 64: 44, 65: 97, 67: 1085, 68: 45, 70: 115, 71: 1086, 72: 47, 73: 100, 74: 118, 75: 1087, 76: 48, 77: 103, 78: 122, 79: 1089, 80: 49, 81: 110, 82: 125, 83: 1091, 84: 50, 85: 114, 86: 127, 87: 1093, 88: 51, 89: 117, 90: 130, 91: 1094, 92: 52, 93: 119, 94: 132, 95: 1095, 96: 53, 97: 124, 98: 135, 99: 1097, 100: 54, 101: 128, 102: 143, 103: 1098, 104: 55, 105: 131, 106: 146, 107: 1100, 108: 56, 109: 134, 110: 147, 111: 1102, 112: 57, 113: 137, 114: 151, 115: 1104, 116: 58, 117: 138, 118: 154, 119: 1106, 120: 59, 121: 139, 122: 157, 123: 1107, 124: 60, 125: 140, 126: 159, 127: 1109, 128: 61, 129: 141, 130: 161, 131: 1111, 132: 62, 133: 142, 134: 163, 135: 1113, 136: 63, 137: 145, 138: 165, 139: 1115, 140: 64, 141: 149, 142: 168, 143: 1117, 144: 65, 145: 152, 146: 171, 147: 1119, 148: 66, 149: 156, 150: 173, 151: 1120, 152: 67, 153: 158, 154: 177, 155: 1124, 156: 68, 157: 160, 158: 179, 159: 1126, 160: 69, 161: 162, 162: 181, 163: 1129, 164: 70, 165: 164, 166: 186, 167: 1130, 168: 71, 169: 175, 170: 187, 171: 1132, 172: 72, 173: 182, 174: 190, 175: 1133, 176: 73, 177: 184, 178: 193, 179: 1136, 180: 74, 181: 188, 182: 194, 183: 1137, 184: 75, 185: 192, 186: 197, 187: 1138, 188: 76, 189: 196, 190: 200, 191: 1140, 192: 77, 193: 198, 194: 204, 195: 1142, 196: 78, 197: 201, 198: 207, 199: 1143, 200: 79, 201: 202, 202: 210, 203: 1144, 204: 80, 206: 215, 207: 1145, 208: 81, 209: 206, 210: 219, 211: 1146, 212: 82, 213: 208, 214: 222, 215: 1147, 216: 83, 217: 211, 218: 224, 219: 1148, 220: 84, 221: 214, 222: 228, 223: 1149, 224: 85, 225: 216, 226: 232, 227: 1150, 228: 88, 229: 218, 230: 237, 231: 1151, 232: 94, 233: 221, 234: 239, 235: 1152, 236: 98, 237: 225, 238: 241, 239: 1153, 240: 102, 241: 226, 242: 245, 243: 1154, 244: 105, 245: 229, 246: 247, 247: 1155, 248: 106, 249: 231, 250: 249, 251: 1156, 252: 108, 253: 234, 254: 253, 255: 1157, 256: 111, 257: 236, 258: 255, 259: 1158, 260: 113, 261: 238, 262: 256, 263: 1159, 264: 116, 265: 242, 266: 259, 267: 1160, 268: 120, 269: 244, 270: 268, 271: 1161, 272: 121, 273: 250, 274: 271, 275: 1162, 276: 123, 277: 251, 278: 273, 279: 1163, 280: 126, 281: 254, 282: 278, 283: 1164, 284: 129, 285: 257, 286: 280, 287: 1165, 288: 133, 289: 261, 290: 283, 291: 1166, 292: 136, 293: 265, 294: 285, 295: 1167, 296: 144, 297: 266, 298: 299, 299: 1168, 300: 148, 301: 270, 302: 304, 303: 1169, 304: 150, 305: 272, 306: 308, 307: 1170, 308: 153, 309: 275, 310: 311, 311: 1171, 312: 155, 313: 290, 314: 313, 315: 1172, 316: 166, 317: 292, 318: 317, 319: 1173, 320: 167, 321: 294, 322: 318, 323: 1174, 324: 169, 325: 296, 326: 320, 327: 1175, 328: 170, 329: 297, 330: 322, 331: 1176, 332: 172, 333: 298, 334: 323, 335: 1177, 336: 174, 337: 302, 338: 325, 339: 1178, 340: 176, 341: 306, 342: 326, 343: 1179, 344: 178, 345: 310, 346: 329, 347: 1180, 348: 180, 349: 314, 350: 332, 351: 1181, 352: 183, 353: 316, 354: 334, 355: 1182, 356: 185, 357: 319, 358: 336, 359: 1183, 360: 189, 361: 321, 362: 338, 363: 1184, 364: 191, 365: 324, 366: 347, 367: 1185, 368: 195, 369: 327, 370: 354, 371: 1186, 372: 199, 373: 328, 374: 357, 375: 1187, 376: 203, 377: 330, 378: 359, 379: 1188, 380: 205, 381: 331, 382: 363, 383: 1189, 384: 209, 385: 333, 386: 365, 387: 1190, 388: 212, 389: 335, 390: 367, 391: 1191, 392: 213, 393: 337, 394: 370, 395: 1192, 396: 217, 397: 339, 398: 373, 399: 1193, 400: 220, 401: 340, 402: 378, 403: 1194, 404: 223, 405: 341, 406: 382, 407: 1195, 408: 227, 409: 342, 410: 383, 411: 1196, 412: 230, 413: 343, 414: 385, 415: 1197, 416: 233, 417: 345, 418: 386, 419: 1198, 420: 235, 421: 346, 422: 388, 423: 1199, 424: 240, 425: 350, 426: 390, 427: 1200, 428: 243, 429: 352, 430: 392, 431: 1201, 432: 246, 433: 355, 434: 394, 435: 1202, 436: 248, 437: 358, 438: 397, 439: 1203, 440: 252, 441: 361, 442: 400, 443: 1204, 444: 258, 445: 366, 446: 406, 447: 1205, 448: 260, 449: 368, 450: 409, 451: 1206, 452: 262, 453: 371, 454: 411, 455: 1207, 456: 263, 457: 375, 458: 414, 459: 1208, 460: 264, 461: 379, 462: 416, 463: 1209, 464: 267, 465: 459, 466: 417, 467: 1210, 468: 269, 469: 461, 470: 419, 471: 1211, 472: 274, 473: 464, 474: 420, 475: 1212, 476: 276, 477: 468, 478: 424, 479: 1213, 480: 277, 481: 470, 482: 425, 483: 1214, 484: 279, 485: 472, 486: 427, 487: 1215, 488: 281, 489: 476, 490: 428, 491: 1216, 492: 282, 493: 477, 494: 430, 495: 1217, 496: 284, 497: 481, 498: 432, 499: 1218, 500: 286, 501: 485, 502: 434, 503: 1219, 504: 287, 505: 487, 506: 436, 507: 1220, 508: 288, 509: 489, 510: 438, 511: 1221, 512: 289, 513: 491, 514: 440, 515: 1222, 516: 291, 517: 495, 518: 441, 519: 1223, 520: 293, 521: 496, 522: 443, 523: 1224, 524: 295, 525: 499, 526: 444, 527: 1225, 528: 300, 529: 502, 530: 447, 531: 1226, 532: 301, 533: 504, 534: 451, 535: 1227, 536: 303, 537: 507, 538: 452, 539: 1228, 540: 305, 541: 509, 542: 454, 543: 1229, 544: 307, 545: 512, 546: 455, 547: 1230, 548: 309, 549: 515, 550: 456, 551: 1231, 552: 312, 553: 518, 554: 458, 555: 1232, 556: 315, 557: 522, 558: 463, 559: 1233, 560: 344, 561: 524, 562: 466, 563: 1234, 564: 348, 565: 526, 566: 474, 567: 1235, 568: 349, 569: 528, 570: 479, 571: 1236, 572: 351, 573: 530, 574: 482, 575: 1237, 576: 353, 577: 532, 579: 1238, 580: 356, 581: 535, 582: 483, 583: 1239, 584: 360, 585: 536, 586: 486, 587: 1240, 588: 362, 589: 538, 590: 490, 591: 1241, 592: 364, 593: 539, 594: 492, 595: 1242, 596: 369, 597: 541, 598: 494, 599: 1243, 600: 372, 601: 543, 602: 497, 603: 1244, 604: 374, 605: 1457, 606: 501, 607: 1245, 608: 376, 609: 546, 610: 505, 611: 1246, 612: 377, 613: 547, 614: 508, 615: 1247, 616: 380, 617: 550, 618: 510, 619: 1248, 620: 381, 621: 552, 622: 514, 623: 1249, 624: 384, 625: 554, 626: 516, 628: 387, 629: 556, 630: 519, 631: 1250, 632: 389, 633: 557, 634: 521, 635: 1251, 636: 391, 637: 559, 638: 630, 639: 1252, 640: 393, 641: 562, 642: 634, 643: 1253, 644: 395, 645: 564, 646: 635, 647: 1254, 648: 396, 649: 565, 650: 637, 651: 1255, 652: 398, 653: 568, 654: 638, 655: 1256, 656: 399, 657: 569, 658: 640, 659: 1257, 660: 401, 661: 574, 662: 645, 663: 1258, 664: 402, 665: 576, 666: 646, 667: 1259, 668: 403, 669: 577, 670: 650, 671: 1260, 672: 404, 673: 579, 674: 652, 675: 1261, 676: 405, 677: 580, 678: 655, 679: 1262, 680: 407, 681: 582, 682: 656, 683: 1263, 684: 408, 685: 584, 686: 658, 687: 1264, 688: 410, 689: 585, 690: 659, 691: 1265, 692: 412, 693: 587, 694: 663, 695: 1266, 696: 413, 697: 588, 698: 664, 699: 1267, 700: 415, 701: 589, 702: 668, 703: 1268, 704: 418, 705: 591, 706: 670, 707: 1269, 708: 421, 709: 593, 710: 671, 711: 1270, 712: 422, 713: 596, 714: 674, 715: 1271, 716: 423, 717: 597, 718: 676, 719: 1272, 720: 426, 721: 599, 722: 680, 723: 1273, 724: 429, 725: 600, 726: 682, 727: 1274, 728: 431, 729: 601, 730: 685, 731: 1275, 732: 433, 733: 603, 734: 687, 735: 1276, 736: 435, 737: 604, 738: 689, 739: 1277, 740: 437, 741: 605, 742: 692, 743: 1278, 744: 439, 745: 607, 746: 695, 747: 1279, 748: 442, 749: 610, 750: 698, 751: 1280, 752: 445, 753: 611, 754: 700, 755: 1281, 756: 446, 757: 613, 758: 703, 759: 1282, 760: 448, 761: 615, 762: 705, 763: 1283, 764: 449, 765: 617, 766: 708, 767: 1284, 768: 450, 769: 618, 770: 711, 771: 1285, 772: 453, 773: 620, 774: 712, 775: 1286, 776: 457, 777: 622, 778: 715, 779: 1287, 780: 460, 781: 623, 782: 717, 783: 1288, 784: 462, 785: 626, 786: 720, 787: 1289, 788: 465, 789: 627, 790: 723, 791: 1290, 792: 467, 793: 629, 794: 726, 795: 1291, 796: 469, 797: 631, 798: 730, 799: 1292, 800: 471, 801: 633, 802: 733, 803: 1293, 804: 473, 805: 636, 806: 736, 807: 1294, 808: 475, 809: 639, 810: 738, 811: 1295, 812: 478, 813: 641, 814: 739, 815: 1296, 816: 480, 817: 643, 818: 743, 819: 1297, 820: 484, 821: 644, 822: 746, 823: 1298, 824: 488, 825: 647, 826: 750, 827: 1299, 828: 493, 829: 648, 830: 754, 831: 1300, 832: 498, 833: 651, 834: 756, 835: 1301, 836: 500, 837: 654, 838: 758, 839: 1302, 840: 503, 841: 657, 842: 760, 843: 1303, 844: 506, 845: 660, 846: 762, 847: 1304, 848: 511, 849: 662, 850: 765, 851: 1305, 852: 513, 853: 665, 854: 767, 855: 1306, 856: 517, 857: 667, 858: 778, 859: 1307, 860: 520, 861: 673, 862: 782, 863: 1308, 864: 523, 865: 677, 866: 784, 867: 1309, 868: 525, 869: 679, 870: 786, 871: 1310, 872: 527, 873: 681, 874: 790, 875: 1311, 876: 529, 877: 684, 878: 793, 879: 1312, 880: 531, 881: 686, 882: 795, 883: 1313, 884: 533, 885: 688, 886: 797, 887: 1314, 888: 534, 889: 690, 890: 800, 891: 1315, 892: 537, 893: 693, 894: 802, 895: 1316, 896: 540, 897: 697, 898: 806, 899: 1317, 900: 542, 901: 699, 902: 810, 903: 1318, 904: 544, 905: 702, 906: 812, 907: 1319, 908: 545, 909: 706, 910: 815, 911: 1320, 912: 548, 913: 709, 914: 817, 915: 1321, 916: 549, 917: 713, 918: 818, 919: 1322, 920: 551, 921: 718, 922: 820, 923: 1323, 924: 553, 925: 721, 926: 821, 927: 1324, 928: 555, 929: 725, 930: 822, 931: 1325, 932: 558, 933: 727, 934: 824, 935: 1326, 936: 560, 937: 728, 938: 826, 939: 1327, 940: 561, 941: 732, 942: 828, 943: 1328, 944: 563, 945: 737, 946: 830, 947: 1329, 948: 566, 949: 741, 950: 833, 951: 1330, 952: 567, 953: 745, 954: 835, 955: 1331, 956: 570, 957: 748, 958: 837, 959: 1332, 960: 571, 961: 749, 962: 841, 963: 1333, 964: 572, 965: 752, 966: 843, 967: 1334, 968: 573, 969: 755, 970: 845, 971: 1335, 972: 575, 973: 763, 974: 850, 975: 1336, 976: 578, 977: 766, 978: 852, 979: 1337, 980: 581, 981: 769, 982: 854, 983: 1338, 984: 583, 985: 771, 986: 855, 988: 586, 989: 774, 990: 858, 991: 1339, 992: 1458, 993: 776, 994: 861, 995: 1340, 996: 590, 997: 777, 998: 863, 999: 1341, 1000: 592, 1001: 779, 1002: 864, 1003: 1342, 1004: 594, 1005: 781, 1006: 866, 1007: 1343, 1008: 595, 1009: 783, 1010: 867, 1011: 1344, 1012: 598, 1013: 787, 1014: 871, 1015: 1345, 1016: 602, 1017: 788, 1018: 875, 1019: 1346, 1020: 1459, 1021: 791, 1022: 880, 1023: 1347, 1024: 606, 1025: 792, 1026: 887, 1027: 1348, 1028: 608, 1029: 796, 1030: 888, 1031: 1349, 1032: 609, 1033: 799, 1034: 890, 1035: 1350, 1036: 612, 1037: 801, 1038: 893, 1039: 1351, 1040: 614, 1041: 803, 1042: 895, 1043: 1352, 1044: 616, 1045: 807, 1046: 899, 1047: 1353, 1048: 619, 1049: 809, 1050: 900, 1051: 1354, 1052: 621, 1053: 811, 1054: 903, 1055: 1355, 1056: 624, 1057: 813, 1058: 904, 1059: 1356, 1060: 625, 1061: 816, 1062: 906, 1063: 1357, 1064: 628, 1065: 823, 1066: 911, 1067: 1358, 1068: 632, 1069: 825, 1070: 915, 1071: 1359, 1072: 642, 1073: 827, 1074: 920, 1075: 1360, 1076: 649, 1077: 831, 1078: 926, 1079: 1361, 1080: 653, 1081: 834, 1082: 932, 1083: 1362, 1084: 661, 1085: 839, 1086: 935, 1087: 1363, 1088: 666, 1089: 842, 1090: 937, 1091: 1364, 1092: 669, 1093: 847, 1094: 938, 1095: 1365, 1096: 672, 1097: 849, 1098: 939, 1099: 1366, 1100: 675, 1101: 853, 1102: 940, 1103: 1367, 1104: 678, 1105: 856, 1106: 941, 1107: 1368, 1108: 683, 1109: 857, 1110: 944, 1111: 1369, 1112: 691, 1113: 859, 1114: 945, 1115: 1370, 1116: 694, 1117: 860, 1118: 946, 1119: 1371, 1120: 696, 1121: 862, 1122: 947, 1123: 1372, 1124: 701, 1125: 865, 1126: 948, 1127: 1373, 1128: 704, 1129: 868, 1130: 950, 1131: 1374, 1132: 707, 1133: 870, 1134: 952, 1135: 1375, 1136: 710, 1137: 873, 1138: 953, 1139: 1376, 1140: 714, 1141: 876, 1142: 955, 1143: 1377, 1144: 716, 1145: 877, 1146: 956, 1147: 1378, 1148: 719, 1149: 878, 1150: 958, 1151: 1379, 1152: 722, 1153: 881, 1154: 959, 1155: 1380, 1156: 724, 1157: 884, 1158: 961, 1159: 1381, 1160: 729, 1161: 885, 1162: 962, 1163: 1382, 1164: 731, 1165: 889, 1166: 964, 1167: 1383, 1168: 734, 1169: 892, 1170: 965, 1171: 1384, 1172: 735, 1173: 896, 1174: 967, 1175: 1385, 1176: 740, 1177: 898, 1178: 969, 1179: 1386, 1180: 742, 1181: 902, 1182: 971, 1183: 1387, 1184: 744, 1185: 905, 1186: 973, 1187: 1388, 1188: 747, 1189: 908, 1190: 974, 1191: 1389, 1192: 751, 1193: 909, 1194: 975, 1195: 1390, 1196: 753, 1197: 912, 1198: 977, 1199: 1391, 1200: 757, 1201: 914, 1202: 979, 1203: 1392, 1204: 759, 1205: 916, 1206: 983, 1207: 1393, 1208: 761, 1209: 918, 1210: 985, 1211: 1394, 1212: 764, 1213: 919, 1214: 987, 1215: 1395, 1216: 768, 1217: 922, 1218: 988, 1219: 1396, 1220: 770, 1221: 923, 1222: 990, 1223: 1397, 1224: 772, 1225: 925, 1226: 993, 1227: 1398, 1228: 773, 1229: 928, 1230: 996, 1231: 1399, 1232: 775, 1233: 929, 1234: 999, 1235: 1400, 1236: 780, 1237: 931, 1238: 1003, 1239: 1401, 1240: 785, 1241: 934, 1243: 1402, 1244: 789, 1245: 936, 1246: 1008, 1247: 1403, 1248: 794, 1249: 942, 1250: 1011, 1251: 1404, 1252: 798, 1253: 943, 1254: 1012, 1255: 1405, 1256: 804, 1257: 949, 1258: 1015, 1259: 1406, 1260: 805, 1261: 951, 1262: 1018, 1263: 1407, 1264: 808, 1265: 954, 1266: 1020, 1267: 1408, 1268: 814, 1269: 957, 1270: 1024, 1271: 1409, 1272: 819, 1273: 960, 1274: 1026, 1275: 1410, 1276: 829, 1277: 963, 1278: 1027, 1279: 1411, 1280: 832, 1281: 966, 1282: 1030, 1283: 1412, 1284: 836, 1285: 968, 1286: 1034, 1287: 1413, 1288: 838, 1289: 970, 1290: 1041, 1291: 1414, 1292: 840, 1293: 972, 1294: 1045, 1295: 1415, 1296: 844, 1297: 976, 1298: 1050, 1299: 1416, 1300: 846, 1301: 978, 1302: 1054, 1303: 1417, 1304: 848, 1305: 980, 1306: 1056, 1307: 1418, 1308: 851, 1309: 981, 1310: 1058, 1311: 1419, 1312: 869, 1313: 982, 1314: 1060, 1315: 1420, 1316: 872, 1317: 984, 1318: 1066, 1319: 1421, 1320: 874, 1321: 986, 1322: 1070, 1323: 1422, 1324: 879, 1325: 989, 1326: 1071, 1327: 1423, 1328: 882, 1329: 994, 1330: 1072, 1331: 1424, 1332: 883, 1333: 995, 1334: 1073, 1335: 1425, 1336: 886, 1337: 997, 1338: 1074, 1339: 1426, 1340: 891, 1341: 1000, 1342: 1075, 1343: 1427, 1344: 894, 1345: 1005, 1346: 1076, 1348: 897, 1349: 1006, 1350: 1077, 1351: 1428, 1352: 901, 1353: 1007, 1354: 1078, 1355: 1429, 1356: 907, 1357: 1009, 1358: 1081, 1359: 1430, 1360: 910, 1361: 1010, 1362: 1084, 1363: 1431, 1364: 913, 1365: 1013, 1366: 1088, 1367: 1432, 1368: 917, 1369: 1014, 1370: 1090, 1371: 1433, 1372: 921, 1373: 1017, 1374: 1092, 1375: 1434, 1376: 924, 1377: 1022, 1378: 1096, 1379: 1435, 1380: 927, 1381: 1028, 1382: 1099, 1383: 1436, 1384: 930, 1385: 1031, 1386: 1101, 1387: 1437, 1388: 933, 1389: 1036, 1390: 1103, 1391: 1438, 1392: 991, 1393: 1040, 1394: 1105, 1395: 1439, 1396: 992, 1397: 1043, 1398: 1108, 1399: 1440, 1400: 998, 1401: 1044, 1402: 1110, 1403: 1441, 1404: 1001, 1405: 1046, 1406: 1112, 1407: 1442, 1408: 1002, 1409: 1048, 1410: 1114, 1411: 1443, 1412: 1004, 1413: 1049, 1414: 1116, 1415: 1444, 1416: 1016, 1417: 1051, 1418: 1118, 1419: 1445, 1420: 1019, 1421: 1052, 1422: 1121, 1423: 1446, 1424: 1021, 1425: 1053, 1426: 1122, 1427: 1447, 1428: 1023, 1429: 1055, 1430: 1123, 1431: 1448, 1432: 1025, 1433: 1057, 1434: 1125, 1435: 1449, 1436: 1029, 1437: 1059, 1438: 1127, 1439: 1450, 1440: 1032, 1441: 1061, 1442: 1128, 1443: 1451, 1444: 1033, 1445: 1062, 1446: 1131, 1447: 1452, 1448: 1035, 1449: 1063, 1450: 1134, 1451: 1453, 1452: 1037, 1455: 1454, 1456: 1038, 1457: 1064, 1458: 1135, 1459: 1455, 1461: 1065, 1464: 1039, 1465: 1067, 1466: 1139, 1467: 1456, 1468: 1042, 1469: 1068, 1472: 1047, 1473: 1069, 1474: 1141, 1478: 1460
               }

    # create this mapping on the POST_SERVER via map_ssn_url.py on the correct db
    map_post = {1: 1461, 2: 1464, 3: 1463, 4: 1470, 5: 1466, 6: 1478, 7: 2907, 8: 1472, 9: 1477, 10: 1479, 11: 1462, 12: 1468, 13: 1467, 14: 1474, 15: 1471, 16: 1492, 17: 1489, 18: 1485, 19: 1482, 20: 1486, 21: 1465, 22: 1473, 23: 1481, 24: 1480, 25: 1483, 26: 1504, 27: 1511, 28: 1496, 29: 1491, 30: 1494, 31: 1469, 32: 1476, 33: 1493, 34: 1488, 35: 1495, 36: 1512, 37: 1518, 38: 1501, 39: 1502, 40: 1498, 41: 1475, 42: 1484, 43: 1500, 44: 1497, 45: 1503, 46: 1521, 47: 1542, 48: 1505, 49: 1506, 50: 1510, 51: 1487, 52: 1490, 53: 1508, 54: 1509, 55: 1513, 56: 1532, 57: 1552, 58: 1515, 59: 1519, 60: 1520, 61: 1507, 62: 1499, 63: 1523, 64: 1514, 65: 1524, 67: 1564, 68: 1526, 70: 1527, 71: 1516, 72: 1517, 73: 1528, 74: 1522, 75: 1534, 76: 1545, 77: 1575, 78: 1531, 79: 1525, 80: 1537, 81: 1536, 82: 1529, 83: 1543, 84: 1533, 85: 1544, 86: 1553, 87: 1581, 88: 1539, 89: 1530, 90: 1550, 91: 1538, 92: 1535, 93: 1546, 94: 1541, 95: 1554, 96: 1561, 97: 1600, 98: 1548, 99: 1540, 100: 1558, 101: 1555, 102: 1573, 103: 1551, 104: 1547, 105: 1566, 106: 1574, 107: 1607, 108: 1559, 109: 1549, 110: 1563, 111: 1571, 112: 1603, 113: 1565, 114: 1557, 115: 1579, 116: 1585, 117: 1613, 118: 1569, 119: 1556, 120: 1577, 121: 1580, 122: 1621, 123: 1570, 124: 1560, 125: 1588, 126: 1592, 127: 1619, 128: 1576, 129: 1562, 130: 1583, 131: 1589, 132: 1629, 133: 1578, 134: 1567, 135: 1596, 136: 1602, 137: 1630, 138: 1584, 139: 1568, 140: 1591, 141: 1598, 142: 1640, 143: 1586, 144: 1572, 145: 1609, 146: 1617, 147: 1634, 148: 1594, 149: 1582, 150: 1604, 151: 1605, 152: 1650, 153: 1599, 154: 1587, 155: 1620, 156: 1628, 157: 1646, 158: 1597, 159: 1593, 160: 1611, 161: 1614, 162: 1660, 163: 1606, 164: 1590, 165: 1625, 166: 1636, 167: 1651, 168: 1601, 169: 1643, 170: 1612, 171: 1622, 172: 1676, 173: 1627, 174: 1595, 175: 1626, 176: 1647, 177: 1655, 178: 1610, 179: 1667, 180: 1618, 181: 1631, 182: 1680, 183: 1641, 184: 1608, 185: 1633, 186: 1658, 187: 1664, 188: 1616, 189: 1682, 190: 1623, 191: 1632, 192: 1690, 193: 1649, 194: 1615, 195: 1645, 196: 1668, 197: 1671, 198: 1624, 199: 1685, 200: 1635, 201: 1637, 202: 1705, 203: 1656, 204: 1638, 206: 1683, 207: 1677, 208: 1648, 209: 1695, 210: 1644, 211: 1639, 212: 1718, 213: 1666, 214: 1642, 215: 1654, 216: 1693, 217: 1688, 218: 1659, 219: 1711, 220: 1653, 221: 1652, 222: 1733, 223: 1669, 224: 2908, 225: 1662, 226: 1703, 227: 1702, 228: 1672, 229: 1717, 230: 1674, 231: 1657, 232: 2909, 233: 1679, 234: 1661, 235: 1675, 236: 1714, 237: 1710, 238: 1681, 239: 1728, 240: 1687, 241: 1663, 242: 1748, 243: 1694, 244: 1670, 245: 1678, 246: 1721, 247: 1716, 248: 1691, 249: 1734, 250: 1692, 251: 1665, 252: 1756, 253: 1701, 254: 1686, 255: 1689, 256: 1726, 257: 1725, 258: 1699, 259: 1737, 260: 1698, 261: 1673, 262: 1759, 263: 1712, 264: 1696, 265: 1700, 266: 1738, 267: 1735, 268: 1706, 269: 1744, 270: 1729, 271: 1684, 272: 1763, 273: 1732, 274: 1704, 275: 1708, 276: 1745, 277: 1739, 278: 1709, 279: 1753, 280: 1746, 281: 1697, 282: 1772, 283: 1741, 284: 1715, 285: 1719, 286: 1747, 287: 1751, 288: 1723, 289: 1768, 290: 1764, 291: 1707, 292: 1779, 293: 1755, 294: 1722, 295: 1724, 296: 1795, 297: 1754, 298: 1781, 299: 1771, 300: 1773, 301: 1713, 302: 1789, 303: 1765, 304: 1736, 305: 1731, 306: 1804, 307: 1762, 308: 1790, 309: 1778, 310: 1780, 311: 1720, 312: 1797, 313: 1818, 314: 1740, 315: 1743, 316: 1855, 317: 1770, 318: 1800, 319: 1785, 320: 1786, 321: 1727, 322: 1813, 323: 1832, 324: 1749, 325: 1752, 326: 1861, 327: 1777, 328: 1807, 329: 1788, 330: 1793, 331: 1730, 332: 1819, 333: 1837, 334: 1757, 335: 1758, 336: 1877, 337: 1784, 338: 1823, 339: 1794, 340: 1803, 341: 1742, 342: 1826, 343: 1847, 344: 1760, 345: 1766, 346: 1892, 347: 1796, 348: 1835, 349: 1802, 350: 1810, 351: 1750, 352: 1830, 353: 1854, 354: 1767, 355: 1776, 356: 1897, 357: 1808, 358: 1844, 359: 1811, 360: 1821, 361: 1761, 362: 1840, 363: 1979, 364: 1774, 365: 1799, 366: 1958, 367: 1814, 368: 1857, 369: 1822, 370: 1841, 371: 1769, 372: 1849, 373: 1989, 374: 1782, 375: 1809, 376: 1970, 377: 1816, 378: 1863, 379: 1829, 380: 1850, 381: 1775, 382: 1862, 383: 2005, 384: 1792, 385: 1817, 386: 1976, 387: 1824, 388: 1872, 389: 1842, 390: 1856, 391: 1783, 392: 1869, 393: 2012, 394: 1801, 395: 1827, 396: 1988, 397: 1828, 398: 1873, 399: 1848, 400: 1864, 401: 1787, 402: 1888, 403: 2020, 404: 1806, 405: 1836, 406: 2007, 407: 1838, 408: 1885, 409: 1858, 410: 1874, 411: 1791, 412: 1896, 413: 2033, 414: 1812, 415: 1843, 416: 2014, 417: 1845, 418: 1887, 419: 1876, 420: 1881, 421: 1798, 422: 1904, 423: 2038, 424: 1825, 425: 1852, 426: 2027, 427: 1868, 428: 1894, 429: 1883, 430: 1889, 431: 1805, 432: 1913, 433: 2050, 434: 1833, 435: 1866, 436: 2036, 437: 1879, 438: 1905, 439: 1893, 440: 1901, 441: 1815, 442: 1921, 443: 2057, 444: 1846, 445: 1884, 446: 2079, 447: 1891, 448: 1912, 449: 1902, 450: 1910, 451: 1820, 452: 1933, 453: 2070, 454: 1851, 455: 1886, 456: 2085, 457: 1899, 458: 1925, 459: 1907, 460: 1918, 461: 1831, 462: 1941, 463: 2163, 464: 1859, 465: 1895, 466: 2088, 467: 1909, 468: 1932, 469: 1916, 470: 1924, 471: 1834, 472: 1955, 473: 2176, 474: 1865, 475: 1898, 476: 2092, 477: 1926, 478: 1939, 479: 1935, 480: 1929, 481: 1839, 482: 1963, 483: 2186, 484: 1871, 485: 1903, 486: 2100, 487: 1930, 488: 1946, 489: 1944, 490: 1937, 491: 1853, 492: 1972, 493: 2195, 494: 1878, 495: 1911, 496: 2104, 497: 1945, 498: 1956, 499: 1949, 500: 1942, 501: 1860, 502: 1980, 503: 2196, 504: 1882, 505: 1915, 506: 2111, 507: 1950, 508: 1969, 509: 1954, 510: 1948, 511: 1867, 512: 1984, 513: 2200, 514: 1890, 515: 1919, 516: 2119, 517: 1964, 518: 1977, 519: 1960, 520: 1952, 521: 1870, 522: 1990, 523: 2212, 524: 2910, 525: 1923, 526: 2131, 527: 2001, 528: 1991, 529: 1968, 530: 1962, 531: 1875, 532: 1992, 533: 2218, 534: 1908, 535: 1927, 536: 2138, 537: 2009, 538: 1995, 539: 1978, 540: 1971, 541: 1880, 542: 1996, 543: 2224, 544: 1914, 545: 1928, 546: 2141, 547: 2017, 548: 1999, 549: 1986, 550: 1974, 551: 2911, 552: 2004, 553: 2241, 554: 1920, 555: 1938, 556: 2152, 557: 2032, 558: 2030, 559: 2000, 560: 1981, 561: 1900, 562: 2024, 563: 2248, 564: 1931, 565: 1953, 566: 2912, 567: 2034, 568: 2039, 569: 2010, 570: 2002, 571: 1906, 572: 2035, 573: 2261, 574: 1940, 575: 1961, 576: 2181, 577: 2045, 579: 2023, 580: 2019, 581: 1917, 582: 2041, 583: 2267, 584: 1947, 585: 1967, 586: 2185, 587: 2046, 588: 2054, 589: 2026, 590: 2029, 591: 1922, 592: 2048, 593: 2275, 594: 1957, 595: 1975, 596: 2197, 597: 2059, 598: 2060, 599: 2040, 600: 2037, 601: 1934, 602: 2056, 603: 2286, 604: 1959, 605: 1983, 606: 2203, 607: 2066, 608: 2069, 609: 2047, 610: 2051, 611: 1936, 612: 2063, 613: 2301, 614: 1965, 615: 1987, 616: 2217, 617: 2084, 618: 2072, 619: 2058, 620: 2062, 621: 1943, 622: 2071, 623: 2305, 624: 1982, 625: 1998, 626: 2232, 628: 2077, 629: 2075, 630: 2074, 631: 1951, 632: 2083, 633: 2913, 634: 1985, 635: 2008, 636: 2242, 637: 2096, 638: 2087, 639: 2093, 640: 2081, 641: 1966, 642: 2094, 643: 2321, 644: 1994, 645: 2013, 646: 2247, 647: 2101, 648: 2095, 649: 2105, 650: 2086, 651: 1973, 652: 2107, 653: 2334, 654: 1997, 655: 2021, 656: 2251, 657: 2108, 658: 2103, 659: 2120, 660: 2097, 661: 1993, 662: 2122, 663: 2340, 664: 2003, 665: 2025, 666: 2256, 667: 2118, 668: 2117, 669: 2132, 670: 2106, 671: 2006, 672: 2130, 673: 2343, 674: 2015, 675: 2031, 676: 2268, 677: 2124, 678: 2125, 679: 2145, 680: 2113, 681: 2011, 682: 2136, 683: 2345, 684: 2018, 685: 2044, 686: 2272, 687: 2137, 688: 2135, 689: 2148, 690: 2116, 691: 2016, 692: 2146, 693: 2350, 694: 2028, 695: 2049, 696: 2276, 697: 2150, 698: 2144, 699: 2156, 700: 2127, 701: 2022, 702: 2154, 703: 2354, 704: 2042, 705: 2055, 706: 2282, 707: 2164, 708: 2151, 709: 2162, 710: 2129, 711: 2043, 712: 2158, 713: 2371, 714: 2053, 715: 2061, 716: 2290, 717: 2168, 718: 2161, 719: 2170, 720: 2143, 721: 2052, 722: 2175, 723: 2376, 724: 2068, 725: 2064, 726: 2298, 727: 2174, 728: 2167, 729: 2179, 730: 2155, 731: 2065, 732: 2177, 733: 2394, 734: 2073, 735: 2067, 736: 2306, 737: 2182, 738: 2183, 739: 2184, 740: 2160, 741: 2076, 742: 2188, 743: 2402, 744: 2082, 745: 2078, 746: 2315, 747: 2189, 748: 2202, 749: 2206, 750: 2166, 751: 2080, 752: 2201, 753: 2411, 754: 2090, 755: 2099, 756: 2316, 757: 2193, 758: 2216, 759: 2209, 760: 2171, 761: 2089, 762: 2211, 763: 2413, 764: 2091, 765: 2109, 766: 2326, 767: 2208, 768: 2221, 769: 2214, 770: 2180, 771: 2102, 772: 2222, 773: 2415, 774: 2098, 775: 2114, 776: 2339, 777: 2220, 778: 2223, 779: 2226, 780: 2192, 781: 2112, 782: 2231, 783: 2423, 784: 2110, 785: 2123, 786: 2344, 787: 2240, 788: 2238, 789: 2230, 790: 2205, 791: 2121, 792: 2236, 793: 2431, 794: 2115, 795: 2142, 796: 2347, 797: 2243, 798: 2254, 799: 2235, 800: 2210, 801: 2133, 802: 2239, 803: 2439, 804: 2126, 805: 2153, 806: 2356, 807: 2253, 808: 2259, 809: 2245, 810: 2215, 811: 2134, 812: 2257, 813: 2445, 814: 2128, 815: 2169, 816: 2361, 817: 2265, 818: 2277, 819: 2250, 820: 2228, 821: 2139, 822: 2266, 823: 2452, 824: 2140, 825: 2178, 826: 2367, 827: 2273, 828: 2291, 829: 2255, 830: 2234, 831: 2147, 832: 2283, 833: 2461, 834: 2149, 835: 2191, 836: 2369, 837: 2288, 838: 2299, 839: 2264, 840: 2246, 841: 2159, 842: 2287, 843: 2466, 844: 2157, 845: 2914, 846: 2375, 847: 2297, 848: 2311, 849: 2270, 850: 2260, 851: 2172, 852: 2296, 853: 2475, 854: 2165, 855: 2198, 856: 2390, 857: 2303, 858: 2364, 859: 2279, 860: 2274, 861: 2190, 862: 2314, 863: 2483, 864: 2173, 865: 2219, 866: 2397, 867: 2308, 868: 2373, 869: 2915, 870: 2284, 871: 2199, 872: 2323, 873: 2491, 874: 2187, 875: 2229, 876: 2410, 877: 2322, 878: 2386, 879: 2304, 880: 2294, 881: 2207, 882: 2336, 883: 2496, 884: 2194, 885: 2233, 886: 2418, 887: 2327, 888: 2393, 889: 2307, 890: 2309, 891: 2213, 892: 2346, 893: 2502, 894: 2204, 895: 2249, 896: 2424, 897: 2333, 898: 2401, 899: 2317, 900: 2318, 901: 2225, 902: 2359, 903: 2513, 904: 2227, 905: 2258, 906: 2428, 907: 2355, 908: 2405, 909: 2330, 910: 2331, 911: 2244, 912: 2382, 913: 2521, 914: 2237, 915: 2278, 916: 2436, 917: 2363, 918: 2406, 919: 2342, 920: 2338, 921: 2263, 922: 2398, 923: 2537, 924: 2252, 925: 2289, 926: 2440, 927: 2377, 928: 2422, 929: 2352, 930: 2916, 931: 2269, 932: 2404, 933: 2547, 934: 2262, 935: 2295, 936: 2450, 937: 2384, 938: 2437, 939: 2358, 940: 2351, 941: 2280, 942: 2409, 943: 2555, 944: 2271, 945: 2310, 946: 2457, 947: 2388, 948: 2451, 949: 2370, 950: 2365, 951: 2292, 952: 2419, 953: 2563, 954: 2281, 955: 2320, 956: 2463, 957: 2391, 958: 2458, 959: 2385, 960: 2372, 961: 2293, 962: 2435, 963: 2570, 964: 2285, 965: 2325, 966: 2468, 967: 2395, 968: 2459, 969: 2392, 970: 2380, 971: 2300, 972: 2446, 973: 2585, 974: 2302, 975: 2335, 976: 2479, 977: 2407, 978: 2465, 979: 2408, 980: 2389, 981: 2312, 982: 2454, 983: 2594, 984: 2313, 985: 2348, 986: 2480, 988: 2473, 989: 2416, 990: 2403, 991: 2319, 992: 2471, 993: 2600, 994: 2324, 995: 2353, 996: 2489, 997: 2421, 998: 2481, 999: 2426, 1000: 2412, 1001: 2329, 1002: 2482, 1003: 2602, 1004: 2328, 1005: 2360, 1006: 2494, 1007: 2425, 1008: 2487, 1009: 2433, 1010: 2420, 1011: 2332, 1012: 2503, 1013: 2611, 1014: 2337, 1015: 2368, 1016: 2506, 1017: 2430, 1018: 2504, 1019: 2441, 1020: 2434, 1021: 2341, 1022: 2523, 1023: 2618, 1024: 2357, 1025: 2374, 1026: 2530, 1027: 2442, 1028: 2510, 1029: 2456, 1030: 2438, 1031: 2349, 1032: 2534, 1033: 2633, 1034: 2917, 1035: 2379, 1036: 2546, 1037: 2447, 1038: 2519, 1039: 2464, 1040: 2443, 1041: 2362, 1042: 2543, 1043: 2640, 1044: 2378, 1045: 2387, 1046: 2553, 1047: 2453, 1048: 2528, 1049: 2474, 1050: 2448, 1051: 2366, 1052: 2551, 1053: 2645, 1054: 2383, 1055: 2396, 1056: 2561, 1057: 2469, 1058: 2536, 1059: 2486, 1060: 2449, 1061: 2381, 1062: 2556, 1063: 2653, 1064: 2399, 1065: 2427, 1066: 2580, 1067: 2477, 1068: 2544, 1069: 2501, 1070: 2467, 1071: 2400, 1072: 2583, 1073: 2662, 1074: 2417, 1075: 2429, 1076: 2592, 1077: 2490, 1078: 2562, 1079: 2512, 1080: 2484, 1081: 2414, 1082: 2622, 1083: 2670, 1084: 2432, 1085: 2460, 1086: 2613, 1087: 2497, 1088: 2574, 1089: 2516, 1090: 2495, 1091: 2472, 1092: 2629, 1093: 2680, 1094: 2444, 1095: 2470, 1096: 2616, 1097: 2505, 1098: 2577, 1099: 2525, 1100: 2509, 1101: 2493, 1102: 2639, 1103: 2694, 1104: 2455, 1105: 2485, 1106: 2621, 1107: 2517, 1108: 2589, 1109: 2532, 1110: 2520, 1111: 2499, 1112: 2657, 1113: 2697, 1114: 2462, 1115: 2492, 1116: 2627, 1117: 2526, 1118: 2591, 1119: 2539, 1120: 2524, 1121: 2508, 1122: 2665, 1123: 2705, 1124: 2476, 1125: 2511, 1126: 2632, 1127: 2606, 1128: 2599, 1129: 2550, 1130: 2533, 1131: 2518, 1132: 2674, 1133: 2712, 1134: 2478, 1135: 2515, 1136: 2638, 1137: 2612, 1138: 2605, 1139: 2559, 1140: 2541, 1141: 2527, 1142: 2682, 1143: 2716, 1144: 2488, 1145: 2522, 1146: 2643, 1147: 2619, 1148: 2610, 1149: 2564, 1150: 2548, 1151: 2538, 1152: 2689, 1153: 2720, 1154: 2498, 1155: 2531, 1156: 2647, 1157: 2628, 1158: 2615, 1159: 2569, 1160: 2560, 1161: 2540, 1162: 2695, 1163: 2737, 1164: 2500, 1165: 2545, 1166: 2658, 1167: 2644, 1168: 2617, 1169: 2578, 1170: 2568, 1171: 2549, 1172: 2701, 1173: 2745, 1174: 2507, 1175: 2552, 1176: 2666, 1177: 2650, 1178: 2626, 1179: 2581, 1180: 2573, 1181: 2557, 1182: 2708, 1183: 2756, 1184: 2514, 1185: 2558, 1186: 2676, 1187: 2655, 1188: 2634, 1189: 2590, 1190: 2579, 1191: 2567, 1192: 2711, 1193: 2760, 1194: 2529, 1195: 2565, 1196: 2679, 1197: 2667, 1198: 2642, 1199: 2597, 1200: 2588, 1201: 2571, 1202: 2718, 1203: 2764, 1204: 2535, 1205: 2572, 1206: 2693, 1207: 2673, 1208: 2646, 1209: 2601, 1210: 2596, 1211: 2576, 1212: 2725, 1213: 2769, 1214: 2542, 1215: 2584, 1216: 2703, 1217: 2681, 1218: 2652, 1219: 2607, 1220: 2603, 1221: 2582, 1222: 2733, 1223: 2772, 1224: 2554, 1225: 2593, 1226: 2715, 1227: 2692, 1228: 2656, 1229: 2620, 1230: 2609, 1231: 2598, 1232: 2740, 1233: 2781, 1234: 2566, 1235: 2608, 1236: 2728, 1237: 2706, 1238: 2664, 1239: 2637, 1240: 2624, 1241: 2614, 1243: 2798, 1244: 2575, 1245: 2625, 1246: 2757, 1247: 2724, 1248: 2685, 1249: 2663, 1250: 2651, 1251: 2631, 1252: 2751, 1253: 2806, 1254: 2586, 1255: 2649, 1256: 2768, 1257: 2753, 1258: 2704, 1259: 2677, 1260: 2654, 1261: 2635, 1262: 2758, 1263: 2810, 1264: 2587, 1265: 2659, 1266: 2773, 1267: 2766, 1268: 2721, 1269: 2698, 1270: 2660, 1271: 2641, 1272: 2761, 1273: 2818, 1274: 2595, 1275: 2671, 1276: 2782, 1277: 2774, 1278: 2730, 1279: 2717, 1280: 2669, 1281: 2668, 1282: 2767, 1283: 2821, 1284: 2604, 1285: 2683, 1286: 2793, 1287: 2777, 1288: 2734, 1289: 2727, 1290: 2687, 1291: 2675, 1292: 2776, 1293: 2825, 1294: 2623, 1295: 2686, 1296: 2800, 1297: 2796, 1298: 2748, 1299: 2738, 1300: 2690, 1301: 2684, 1302: 2791, 1303: 2836, 1304: 2630, 1305: 2920, 1306: 2807, 1307: 2815, 1308: 2754, 1309: 2743, 1310: 2699, 1311: 2691, 1312: 2844, 1313: 2837, 1314: 2636, 1315: 2713, 1316: 2816, 1317: 2822, 1318: 2775, 1319: 2759, 1320: 2702, 1321: 2700, 1322: 2851, 1323: 2843, 1324: 2648, 1325: 2726, 1326: 2823, 1327: 2827, 1328: 2780, 1329: 2771, 1330: 2710, 1331: 2707, 1332: 2856, 1333: 2845, 1334: 2661, 1335: 2735, 1336: 2830, 1337: 2833, 1338: 2787, 1339: 2778, 1340: 2722, 1341: 2714, 1342: 2860, 1343: 2847, 1344: 2672, 1345: 2744, 1346: 2835, 1348: 2792, 1349: 2784, 1350: 2729, 1351: 2731, 1352: 2867, 1353: 2857, 1354: 2678, 1355: 2750, 1356: 2842, 1357: 2840, 1358: 2803, 1359: 2788, 1360: 2741, 1361: 2739, 1362: 2878, 1363: 2866, 1364: 2688, 1365: 2765, 1366: 2854, 1367: 2853, 1368: 2812, 1369: 2797, 1370: 2755, 1371: 2749, 1372: 2885, 1373: 2870, 1374: 2696, 1375: 2779, 1376: 2863, 1377: 2864, 1378: 2829, 1379: 2804, 1380: 2762, 1381: 2763, 1382: 2890, 1383: 2874, 1384: 2709, 1385: 2785, 1386: 2871, 1387: 2868, 1388: 2841, 1389: 2813, 1390: 2770, 1391: 2786, 1392: 2898, 1393: 2880, 1394: 2719, 1395: 2789, 1396: 2873, 1397: 2872, 1398: 2846, 1399: 2819, 1400: 2783, 1401: 2794, 1402: 2899, 1403: 2884, 1404: 2723, 1405: 2795, 1406: 2875, 1407: 2876, 1408: 2849, 1409: 2820, 1410: 2790, 1411: 2805, 1412: 2900, 1413: 2886, 1414: 2732, 1415: 2799, 1416: 2879, 1417: 2877, 1418: 2852, 1419: 2826, 1420: 2801, 1421: 2809, 1422: 2901, 1423: 2889, 1424: 2736, 1425: 2808, 1426: 2882, 1427: 2881, 1428: 2855, 1429: 2831, 1430: 2802, 1431: 2848, 1432: 2902, 1433: 2891, 1434: 2742, 1435: 2918, 1436: 2887, 1437: 2883, 1438: 2859, 1439: 2832, 1440: 2811, 1441: 2850, 1442: 2904, 1443: 2894, 1444: 2746, 1445: 2817, 1446: 2892, 1447: 2888, 1448: 2861, 1449: 2834, 1450: 2814, 1451: 2858, 1452: 2905, 1455: 2824, 1456: 2896, 1457: 2893, 1458: 2865, 1459: 2838, 1461: 2862, 1464: 2747, 1465: 2828, 1466: 2903, 1467: 2895, 1468: 2869, 1469: 2839, 1472: 2906, 1473: 2897, 1474: 2752, 1478: 2919
}

    # ssn_sheets = [2]
    sheets = [1789] #range(1916, 2000)
    for sheet_id in sheets:  # id or ssn_sheet number
        # post_btween_sandboxes(sheet_ssn, map_post, map_get)
        post_btween_sandboxes(id=sheet_id, id_post=155835)#map_ssn_url_get=map_get, map_ssn_url_post=map_post, new_post=True)

# Delete duplicates
# for sheet_id in range(151200, 151843):
#     sheets = db.sheets.count_documents({'id': sheet_id})
#     if sheets > 1:
#         print sheet_id
#         cursor = db.sheets.find({'id': sheet_id})
#         for s in cursor:
#             db.sheets.remove(s)
#             break